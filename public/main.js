'use strict';

window.app = angular.module('portfolio', ['ui.router']);

app.config(function ($urlRouterProvider, $locationProvider, $urlMatcherFactoryProvider) {

	// this makes the '/stores/' route correctly redirect to '/stores'
	$urlRouterProvider.rule(function ($injector, $location) {

		var re = /(.+)(\/+)(\?.*)?$/;
		var path = $location.url();

		if (re.test(path)) {
			return path.replace(re, '$1$3');
		}

		return false;
	});
	// This turns off hashbang urls (/#about) and changes it to something normal (/about)
	$locationProvider.html5Mode(true);
	$urlRouterProvider.when('/auth/:provider', function () {
		window.location.reload();
	});
	// If we go to a URL that ui-router doesn't have registered, go to the "/" url.
	$urlRouterProvider.otherwise('/');
});

app.controller('aboutCtrl', function ($scope) {
	var increment = 0;
	var carousel = $('#carousel');
	var current = '#fig-1';
	var prev;
	setInterval(function () {
		increment++;
		carousel.css({
			'-webkit-transform': 'rotateX(' + increment * -60 + 'deg)'
		});
		carousel.attr('data-state', increment % 6 + 1);

		prev = current;
		current = '#fig-' + +(increment % 6 + 1);
		// console.log(current);
		// $(current).css({'border-radius' : '30px'});
		// $(prev).css({'border-radius' : '0px'});
	}, 1500);
});

app.controller('contactCtrl', function ($scope, $http) {
	$scope.formData = {};

	$scope.sendMail = function () {
		$scope.waiting = true;
		$scope.sent = false;
		$scope.success = false;
		$http.post('/api/contact', $scope.formData).then(function (successResponse) {
			console.log(successResponse);
			$scope.waiting = false;
			$scope.sent = true;
			$scope.success = successResponse.data;
			$scope.formData = {};
		});
	};

	var card = $('#card');
	var note = $('#note');
	var toggle = true;

	card.click(function () {
		if (toggle) {
			card.addClass('slideRight');
			note.css({ 'display': 'initial' });
			explode();
			console.log('exploded');
		} else {
			card.removeClass('slideRight');
			note.css({ 'display': 'none' });
		}
		toggle = !toggle;
	});

	function explode() {
		// cr√©ation d'un tableau
		var canvas = document.getElementById("canvas"),
		    context = canvas.getContext("2d"),
		    width = canvas.width = window.innerWidth,
		    height = canvas.height = window.innerHeight,
		    particle = [],
		    particleCount = 0,
		    gravity = 0.3,
		    colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800', '#FF5722', '#795548'];

		for (var i = 0; i < 300; i++) {
			particle.push({
				x: width / 2,
				y: height / 2,
				boxW: randomRange(5, 20),
				boxH: randomRange(5, 20),
				size: randomRange(2, 8),

				spikeran: randomRange(3, 5),

				velX: randomRange(-8, 8),
				velY: randomRange(-50, -10),

				angle: convertToRadians(randomRange(0, 360)),
				color: colors[Math.floor(Math.random() * colors.length)],
				anglespin: randomRange(-0.2, 0.2),

				draw: function draw() {
					context.save();
					context.translate(this.x, this.y);
					context.rotate(this.angle);
					context.fillStyle = this.color;
					context.beginPath();
					// drawStar(0, 0, 5, this.boxW, this.boxH);
					context.fillRect(this.boxW / 2 * -1, this.boxH / 2 * -1, this.boxW, this.boxH);
					context.fill();
					context.closePath();
					context.restore();
					this.angle += this.anglespin;
					this.velY *= 0.999;
					this.velY += 0.3;
					this.x += this.velX;
					this.y += this.velY;

					if (this.y < 0) {
						this.velY *= -0.2;
						this.velX *= 0.9;
					}
					if (this.y > height) {
						this.anglespin = 0;
						this.y = height;
						this.velY *= -0.2;
						this.velX *= 0.9;
					}
					if (this.x > width || this.x < 0) {
						this.velX *= -0.5;
					}
				}
			});
		}

		var r1 = {
			x: width / 2 - 150,
			y: height / 2 - 150,
			width: 300,
			height: 300,
			velX: 0,
			velY: -10,
			img: loadImage("http://image.noelshack.com/fichiers/2015/12/1427051642-smiley.png"),
			alphatop: 0
		};

		function drawScreen() {
			var size = 50;
			var pFontName = "Lucida Sans Unicode";
			context.font = size + "pt " + pFontName;
			context.fillText("Confetti party !!!", width / 2, 150);
			if (r1.alphatop < 1) {
				r1.alphatop += 0.01;
			} else {
				r1.alphatop = 1;
			}
			context.globalAlpha = r1.alphatop;
			context.drawImage(r1.img, r1.x, r1.y);
			context.textAlign = 'center';

			if (r1.alphatop === 1) {
				r1.velY *= 0.999;
				r1.velY += 0.3;
				r1.x += r1.velX;
				r1.y += r1.velY;
			}

			if (r1.y + r1.height > height) {
				r1.anglespin = 0;
				r1.y = height - r1.height;
				r1.velY *= -0.8;
				r1.velX *= 0.9;
			}

			context.globalAlpha = 1;

			for (var i = 0; i < particle.length; i++) {
				particle[i].draw();
			}
		}

		function loadImage(url) {
			var img = document.createElement("img");
			img.src = url;
			return img;
		}

		function update() {
			context.clearRect(0, 0, width, height);
			drawScreen();
			requestAnimationFrame(update);
		}

		update();

		function randomRange(min, max) {
			return min + Math.random() * (max - min);
		}

		function randomInt(min, max) {
			return Math.floor(min + Math.random() * (max - min + 1));
		}

		function convertToRadians(degree) {
			return degree * (Math.PI / 180);
		}

		function drawStar(cx, cy, spikes, outerRadius, innerRadius, color) {
			var rot = Math.PI / 2 * 3;
			var x = cx;
			var y = cy;
			var step = Math.PI / spikes;

			context.strokeSyle = "#000";
			context.beginPath();
			context.moveTo(cx, cy - outerRadius);

			for (i = 0; i < spikes; i++) {
				x = cx + Math.cos(rot) * outerRadius;
				y = cy + Math.sin(rot) * outerRadius;
				context.lineTo(x, y);
				rot += step;

				x = cx + Math.cos(rot) * innerRadius;
				y = cy + Math.sin(rot) * innerRadius;
				context.lineTo(x, y);
				rot += step;
			}

			context.lineTo(cx, cy - outerRadius);
			context.closePath();
			context.fillStyle = color;
			context.fill();
		}
	}
});

app.config(function ($stateProvider) {
	$stateProvider.state('home', {
		url: '/',
		templateUrl: '/js/templates/home.html'
	}).state('projects', {
		url: '/projects',
		templateUrl: '/js/templates/projects.html',
		controller: 'projectCtrl'
	}).state('about', {
		url: '/about',
		templateUrl: '/js/templates/about.html',
		controller: 'aboutCtrl'
	}).state('contact', {
		url: '/contact',
		templateUrl: '/js/templates/contact.html',
		controller: 'contactCtrl'
	});
});

app.controller('projectCtrl', function ($scope) {
	$(document).ready(function () {

		var curPage = 1;
		var numOfPages = $(".skw-page").length;
		var animTime = 1000;
		var scrolling = false;
		var pgPrefix = ".skw-page-";

		function pagination() {
			scrolling = true;

			$(pgPrefix + curPage).removeClass("inactive").addClass("active");
			$(pgPrefix + (curPage - 1)).addClass("inactive");
			$(pgPrefix + (curPage + 1)).removeClass("active");

			setTimeout(function () {
				scrolling = false;
			}, animTime);
		}

		function navigateUp() {
			if (curPage === 1) return;
			curPage--;
			pagination();
		}

		function navigateDown() {
			if (curPage === numOfPages) return;
			curPage++;
			pagination();
		}

		$(document).on("mousewheel DOMMouseScroll", function (e) {
			if (scrolling) return;
			if (e.originalEvent.wheelDelta > 0 || e.originalEvent.detail < 0) {
				navigateUp();
			} else {
				navigateDown();
			}
		});

		$(document).on("keydown", function (e) {
			if (scrolling) return;
			if (e.which === 38) {
				navigateUp();
			} else if (e.which === 40) {
				navigateDown();
			}
		});

		$('#down-arrow').click(function () {
			console.log('clicked');
			if (scrolling) return;
			navigateDown();
		});
	});
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImFib3V0LmpzIiwiY29udGFjdC5qcyIsImhvbWUuanMiLCJwcm9qZWN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBQSxDQUFBLEdBQUEsR0FBQSxPQUFBLENBQUEsTUFBQSxDQUFBLFdBQUEsRUFBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBLENBQUE7O0FBRUEsR0FBQSxDQUFBLE1BQUEsQ0FBQSxVQUFBLGtCQUFBLEVBQUEsaUJBQUEsRUFBQSwwQkFBQSxFQUFBOzs7QUFHQSxtQkFBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLFNBQUEsRUFBQSxTQUFBLEVBQUE7O0FBRUEsTUFBQSxFQUFBLEdBQUEsbUJBQUEsQ0FBQTtBQUNBLE1BQUEsSUFBQSxHQUFBLFNBQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQTs7QUFFQSxNQUFBLEVBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLEVBQUE7QUFDQSxVQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsRUFBQSxFQUFBLE1BQUEsQ0FBQSxDQUFBO0dBQ0E7O0FBRUEsU0FBQSxLQUFBLENBQUE7RUFDQSxDQUFBOztBQUFBLEFBRUEsa0JBQUEsQ0FBQSxTQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7QUFDQSxtQkFBQSxDQUFBLElBQUEsQ0FBQSxpQkFBQSxFQUFBLFlBQUE7QUFDQSxRQUFBLENBQUEsUUFBQSxDQUFBLE1BQUEsRUFBQSxDQUFBO0VBQ0EsQ0FBQTs7QUFBQSxBQUVBLG1CQUFBLENBQUEsU0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO0NBQ0EsQ0FBQSxDQUFBOztBQ3ZCQSxHQUFBLENBQUEsVUFBQSxDQUFBLFdBQUEsRUFBQSxVQUFBLE1BQUEsRUFBQTtBQUNBLEtBQUEsU0FBQSxHQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsUUFBQSxHQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsT0FBQSxHQUFBLFFBQUEsQ0FBQTtBQUNBLEtBQUEsSUFBQSxDQUFBO0FBQ0EsWUFBQSxDQUFBLFlBQUE7QUFDQSxXQUFBLEVBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxHQUFBLENBQUE7QUFDQSxzQkFBQSxFQUFBLFVBQUEsR0FBQSxTQUFBLEdBQUEsQ0FBQSxFQUFBLEdBQUEsTUFBQTtHQUNBLENBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxJQUFBLENBQUEsWUFBQSxFQUFBLFNBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUE7O0FBRUEsTUFBQSxHQUFBLE9BQUEsQ0FBQTtBQUNBLFNBQUEsR0FBQSxPQUFBLEdBQUEsRUFBQSxTQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTs7OztFQUtBLEVBQUEsSUFBQSxDQUFBLENBQUE7QUFMQSxDQU1BLENBQUEsQ0FBQTs7QUNuQkEsR0FBQSxDQUFBLFVBQUEsQ0FBQSxhQUFBLEVBQUEsVUFBQSxNQUFBLEVBQUEsS0FBQSxFQUFBO0FBQ0EsT0FBQSxDQUFBLFFBQUEsR0FBQSxFQUFBLENBQUE7O0FBRUEsT0FBQSxDQUFBLFFBQUEsR0FBQSxZQUFBO0FBQ0EsUUFBQSxDQUFBLE9BQUEsR0FBQSxJQUFBLENBQUE7QUFDQSxRQUFBLENBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQTtBQUNBLFFBQUEsQ0FBQSxPQUFBLEdBQUEsS0FBQSxDQUFBO0FBQ0EsT0FBQSxDQUFBLElBQUEsQ0FBQSxjQUFBLEVBQUEsTUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUNBLElBQUEsQ0FBQSxVQUFBLGVBQUEsRUFBQTtBQUNBLFVBQUEsQ0FBQSxHQUFBLENBQUEsZUFBQSxDQUFBLENBQUE7QUFDQSxTQUFBLENBQUEsT0FBQSxHQUFBLEtBQUEsQ0FBQTtBQUNBLFNBQUEsQ0FBQSxJQUFBLEdBQUEsSUFBQSxDQUFBO0FBQ0EsU0FBQSxDQUFBLE9BQUEsR0FBQSxlQUFBLENBQUEsSUFBQSxDQUFBO0FBQ0EsU0FBQSxDQUFBLFFBQUEsR0FBQSxFQUFBLENBQUE7R0FDQSxDQUFBLENBQUE7RUFDQSxDQUFBOztBQUVBLEtBQUEsSUFBQSxHQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsSUFBQSxHQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsTUFBQSxHQUFBLElBQUEsQ0FBQTs7QUFFQSxLQUFBLENBQUEsS0FBQSxDQUFBLFlBQUE7QUFDQSxNQUFBLE1BQUEsRUFBQTtBQUNBLE9BQUEsQ0FBQSxRQUFBLENBQUEsWUFBQSxDQUFBLENBQUE7QUFDQSxPQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsRUFBQSxDQUFBLENBQUE7QUFDQSxVQUFBLEVBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxHQUFBLENBQUEsVUFBQSxDQUFBLENBQUE7R0FDQSxNQUFBO0FBQ0EsT0FBQSxDQUFBLFdBQUEsQ0FBQSxZQUFBLENBQUEsQ0FBQTtBQUNBLE9BQUEsQ0FBQSxHQUFBLENBQUEsRUFBQSxTQUFBLEVBQUEsTUFBQSxFQUFBLENBQUEsQ0FBQTtHQUNBO0FBQ0EsUUFBQSxHQUFBLENBQUEsTUFBQSxDQUFBO0VBQ0EsQ0FBQSxDQUFBOztBQUVBLFVBQUEsT0FBQSxHQUFBOztBQUVBLE1BQUEsTUFBQSxHQUFBLFFBQUEsQ0FBQSxjQUFBLENBQUEsUUFBQSxDQUFBO01BQ0EsT0FBQSxHQUFBLE1BQUEsQ0FBQSxVQUFBLENBQUEsSUFBQSxDQUFBO01BQ0EsS0FBQSxHQUFBLE1BQUEsQ0FBQSxLQUFBLEdBQUEsTUFBQSxDQUFBLFVBQUE7TUFDQSxNQUFBLEdBQUEsTUFBQSxDQUFBLE1BQUEsR0FBQSxNQUFBLENBQUEsV0FBQTtNQUNBLFFBQUEsR0FBQSxFQUFBO01BQ0EsYUFBQSxHQUFBLENBQUE7TUFDQSxPQUFBLEdBQUEsR0FBQTtNQUNBLE1BQUEsR0FBQSxDQUNBLFNBQUEsRUFBQSxTQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsRUFBQSxTQUFBLEVBQ0EsU0FBQSxFQUFBLFNBQUEsRUFBQSxTQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsRUFDQSxTQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsRUFBQSxTQUFBLEVBQUEsU0FBQSxFQUNBLFNBQUEsRUFBQSxTQUFBLENBQ0EsQ0FBQTs7QUFFQSxPQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsRUFBQSxDQUFBLEdBQUEsR0FBQSxFQUFBLENBQUEsRUFBQSxFQUFBO0FBQ0EsV0FBQSxDQUFBLElBQUEsQ0FBQTtBQUNBLEtBQUEsRUFBQSxLQUFBLEdBQUEsQ0FBQTtBQUNBLEtBQUEsRUFBQSxNQUFBLEdBQUEsQ0FBQTtBQUNBLFFBQUEsRUFBQSxXQUFBLENBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQTtBQUNBLFFBQUEsRUFBQSxXQUFBLENBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQTtBQUNBLFFBQUEsRUFBQSxXQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQTs7QUFFQSxZQUFBLEVBQUEsV0FBQSxDQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7O0FBRUEsUUFBQSxFQUFBLFdBQUEsQ0FBQSxDQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7QUFDQSxRQUFBLEVBQUEsV0FBQSxDQUFBLENBQUEsRUFBQSxFQUFBLENBQUEsRUFBQSxDQUFBOztBQUVBLFNBQUEsRUFBQSxnQkFBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBLEVBQUEsR0FBQSxDQUFBLENBQUE7QUFDQSxTQUFBLEVBQUEsTUFBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsRUFBQSxHQUFBLE1BQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQTtBQUNBLGFBQUEsRUFBQSxXQUFBLENBQUEsQ0FBQSxHQUFBLEVBQUEsR0FBQSxDQUFBOztBQUVBLFFBQUEsRUFBQSxnQkFBQTtBQUNBLFlBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtBQUNBLFlBQUEsQ0FBQSxTQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsRUFBQSxJQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7QUFDQSxZQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQTtBQUNBLFlBQUEsQ0FBQSxTQUFBLEdBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQTtBQUNBLFlBQUEsQ0FBQSxTQUFBLEVBQUE7O0FBQUEsQUFFQSxZQUFBLENBQUEsUUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxFQUFBLElBQUEsQ0FBQSxJQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxFQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO0FBQ0EsWUFBQSxDQUFBLElBQUEsRUFBQSxDQUFBO0FBQ0EsWUFBQSxDQUFBLFNBQUEsRUFBQSxDQUFBO0FBQ0EsWUFBQSxDQUFBLE9BQUEsRUFBQSxDQUFBO0FBQ0EsU0FBQSxDQUFBLEtBQUEsSUFBQSxJQUFBLENBQUEsU0FBQSxDQUFBO0FBQ0EsU0FBQSxDQUFBLElBQUEsSUFBQSxLQUFBLENBQUE7QUFDQSxTQUFBLENBQUEsSUFBQSxJQUFBLEdBQUEsQ0FBQTtBQUNBLFNBQUEsQ0FBQSxDQUFBLElBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQTtBQUNBLFNBQUEsQ0FBQSxDQUFBLElBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQTs7QUFFQSxTQUFBLElBQUEsQ0FBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBO0FBQ0EsVUFBQSxDQUFBLElBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxJQUFBLElBQUEsR0FBQSxDQUFBO01BQ0E7QUFDQSxTQUFBLElBQUEsQ0FBQSxDQUFBLEdBQUEsTUFBQSxFQUFBO0FBQ0EsVUFBQSxDQUFBLFNBQUEsR0FBQSxDQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsQ0FBQSxHQUFBLE1BQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxHQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsSUFBQSxJQUFBLEdBQUEsQ0FBQTtNQUNBO0FBQ0EsU0FBQSxJQUFBLENBQUEsQ0FBQSxHQUFBLEtBQUEsSUFBQSxJQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsRUFBQTtBQUNBLFVBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxHQUFBLENBQUE7TUFDQTtLQUVBO0lBQ0EsQ0FBQSxDQUFBO0dBQ0E7O0FBRUEsTUFBQSxFQUFBLEdBQUE7QUFDQSxJQUFBLEVBQUEsS0FBQSxHQUFBLENBQUEsR0FBQSxHQUFBO0FBQ0EsSUFBQSxFQUFBLE1BQUEsR0FBQSxDQUFBLEdBQUEsR0FBQTtBQUNBLFFBQUEsRUFBQSxHQUFBO0FBQ0EsU0FBQSxFQUFBLEdBQUE7QUFDQSxPQUFBLEVBQUEsQ0FBQTtBQUNBLE9BQUEsRUFBQSxDQUFBLEVBQUE7QUFDQSxNQUFBLEVBQUEsU0FBQSxDQUFBLG1FQUFBLENBQUE7QUFDQSxXQUFBLEVBQUEsQ0FBQTtHQUNBLENBQUE7O0FBR0EsV0FBQSxVQUFBLEdBQUE7QUFDQSxPQUFBLElBQUEsR0FBQSxFQUFBLENBQUE7QUFDQSxPQUFBLFNBQUEsR0FBQSxxQkFBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLElBQUEsR0FBQSxJQUFBLEdBQUEsS0FBQSxHQUFBLFNBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxRQUFBLENBQUEsb0JBQUEsRUFBQSxLQUFBLEdBQUEsQ0FBQSxFQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQ0EsT0FBQSxFQUFBLENBQUEsUUFBQSxHQUFBLENBQUEsRUFBQTtBQUNBLE1BQUEsQ0FBQSxRQUFBLElBQUEsSUFBQSxDQUFBO0lBQ0EsTUFBQTtBQUNBLE1BQUEsQ0FBQSxRQUFBLEdBQUEsQ0FBQSxDQUFBO0lBQ0E7QUFDQSxVQUFBLENBQUEsV0FBQSxHQUFBLEVBQUEsQ0FBQSxRQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsU0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLEVBQUEsRUFBQSxDQUFBLENBQUEsRUFBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsU0FBQSxHQUFBLFFBQUEsQ0FBQTs7QUFJQSxPQUFBLEVBQUEsQ0FBQSxRQUFBLEtBQUEsQ0FBQSxFQUFBO0FBQ0EsTUFBQSxDQUFBLElBQUEsSUFBQSxLQUFBLENBQUE7QUFDQSxNQUFBLENBQUEsSUFBQSxJQUFBLEdBQUEsQ0FBQTtBQUNBLE1BQUEsQ0FBQSxDQUFBLElBQUEsRUFBQSxDQUFBLElBQUEsQ0FBQTtBQUNBLE1BQUEsQ0FBQSxDQUFBLElBQUEsRUFBQSxDQUFBLElBQUEsQ0FBQTtJQUNBOztBQUVBLE9BQUEsRUFBQSxDQUFBLENBQUEsR0FBQSxFQUFBLENBQUEsTUFBQSxHQUFBLE1BQUEsRUFBQTtBQUNBLE1BQUEsQ0FBQSxTQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQ0EsTUFBQSxDQUFBLENBQUEsR0FBQSxNQUFBLEdBQUEsRUFBQSxDQUFBLE1BQUEsQ0FBQTtBQUNBLE1BQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxHQUFBLENBQUE7QUFDQSxNQUFBLENBQUEsSUFBQSxJQUFBLEdBQUEsQ0FBQTtJQUNBOztBQUVBLFVBQUEsQ0FBQSxXQUFBLEdBQUEsQ0FBQSxDQUFBOztBQUVBLFFBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxRQUFBLENBQUEsTUFBQSxFQUFBLENBQUEsRUFBQSxFQUFBO0FBQ0EsWUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsRUFBQSxDQUFBO0lBQ0E7R0FDQTs7QUFFQSxXQUFBLFNBQUEsQ0FBQSxHQUFBLEVBQUE7QUFDQSxPQUFBLEdBQUEsR0FBQSxRQUFBLENBQUEsYUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO0FBQ0EsTUFBQSxDQUFBLEdBQUEsR0FBQSxHQUFBLENBQUE7QUFDQSxVQUFBLEdBQUEsQ0FBQTtHQUNBOztBQUVBLFdBQUEsTUFBQSxHQUFBO0FBQ0EsVUFBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEtBQUEsRUFBQSxNQUFBLENBQUEsQ0FBQTtBQUNBLGFBQUEsRUFBQSxDQUFBO0FBQ0Esd0JBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQTtHQUNBOztBQUVBLFFBQUEsRUFBQSxDQUFBOztBQUVBLFdBQUEsV0FBQSxDQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUE7QUFDQSxVQUFBLEdBQUEsR0FBQSxJQUFBLENBQUEsTUFBQSxFQUFBLElBQUEsR0FBQSxHQUFBLEdBQUEsQ0FBQSxDQUFBO0dBQ0E7O0FBRUEsV0FBQSxTQUFBLENBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQTtBQUNBLFVBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxHQUFBLEdBQUEsSUFBQSxDQUFBLE1BQUEsRUFBQSxJQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtHQUNBOztBQUVBLFdBQUEsZ0JBQUEsQ0FBQSxNQUFBLEVBQUE7QUFDQSxVQUFBLE1BQUEsSUFBQSxJQUFBLENBQUEsRUFBQSxHQUFBLEdBQUEsQ0FBQSxDQUFBO0dBQ0E7O0FBRUEsV0FBQSxRQUFBLENBQUEsRUFBQSxFQUFBLEVBQUEsRUFBQSxNQUFBLEVBQUEsV0FBQSxFQUFBLFdBQUEsRUFBQSxLQUFBLEVBQUE7QUFDQSxPQUFBLEdBQUEsR0FBQSxJQUFBLENBQUEsRUFBQSxHQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7QUFDQSxPQUFBLENBQUEsR0FBQSxFQUFBLENBQUE7QUFDQSxPQUFBLENBQUEsR0FBQSxFQUFBLENBQUE7QUFDQSxPQUFBLElBQUEsR0FBQSxJQUFBLENBQUEsRUFBQSxHQUFBLE1BQUEsQ0FBQTs7QUFFQSxVQUFBLENBQUEsVUFBQSxHQUFBLE1BQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxTQUFBLEVBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxNQUFBLENBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxXQUFBLENBQUEsQ0FBQTs7QUFFQSxRQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLE1BQUEsRUFBQSxDQUFBLEVBQUEsRUFBQTtBQUNBLEtBQUEsR0FBQSxFQUFBLEdBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxXQUFBLENBQUE7QUFDQSxLQUFBLEdBQUEsRUFBQSxHQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsV0FBQSxDQUFBO0FBQ0EsV0FBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUE7QUFDQSxPQUFBLElBQUEsSUFBQSxDQUFBOztBQUVBLEtBQUEsR0FBQSxFQUFBLEdBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxXQUFBLENBQUE7QUFDQSxLQUFBLEdBQUEsRUFBQSxHQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsV0FBQSxDQUFBO0FBQ0EsV0FBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUE7QUFDQSxPQUFBLElBQUEsSUFBQSxDQUFBO0lBQ0E7O0FBRUEsVUFBQSxDQUFBLE1BQUEsQ0FBQSxFQUFBLEVBQUEsRUFBQSxHQUFBLFdBQUEsQ0FBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLFNBQUEsRUFBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLFNBQUEsR0FBQSxLQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsSUFBQSxFQUFBLENBQUE7R0FDQTtFQUNBO0NBRUEsQ0FBQSxDQUFBOztBQzlNQSxHQUFBLENBQUEsTUFBQSxDQUFBLFVBQUEsY0FBQSxFQUFBO0FBQ0EsZUFBQSxDQUNBLEtBQUEsQ0FBQSxNQUFBLEVBQUE7QUFDQSxLQUFBLEVBQUEsR0FBQTtBQUNBLGFBQUEsRUFBQSx5QkFBQTtFQUNBLENBQUEsQ0FDQSxLQUFBLENBQUEsVUFBQSxFQUFBO0FBQ0EsS0FBQSxFQUFBLFdBQUE7QUFDQSxhQUFBLEVBQUEsNkJBQUE7QUFDQSxZQUFBLEVBQUEsYUFBQTtFQUNBLENBQUEsQ0FDQSxLQUFBLENBQUEsT0FBQSxFQUFBO0FBQ0EsS0FBQSxFQUFBLFFBQUE7QUFDQSxhQUFBLEVBQUEsMEJBQUE7QUFDQSxZQUFBLEVBQUEsV0FBQTtFQUNBLENBQUEsQ0FDQSxLQUFBLENBQUEsU0FBQSxFQUFBO0FBQ0EsS0FBQSxFQUFBLFVBQUE7QUFDQSxhQUFBLEVBQUEsNEJBQUE7QUFDQSxZQUFBLEVBQUEsYUFBQTtFQUNBLENBQUEsQ0FBQTtDQUNBLENBQUEsQ0FBQTs7QUNyQkEsR0FBQSxDQUFBLFVBQUEsQ0FBQSxhQUFBLEVBQUEsVUFBQSxNQUFBLEVBQUE7QUFDQSxFQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsS0FBQSxDQUFBLFlBQUE7O0FBRUEsTUFBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQ0EsTUFBQSxVQUFBLEdBQUEsQ0FBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQTtBQUNBLE1BQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtBQUNBLE1BQUEsU0FBQSxHQUFBLEtBQUEsQ0FBQTtBQUNBLE1BQUEsUUFBQSxHQUFBLFlBQUEsQ0FBQTs7QUFFQSxXQUFBLFVBQUEsR0FBQTtBQUNBLFlBQUEsR0FBQSxJQUFBLENBQUE7O0FBRUEsSUFBQSxDQUFBLFFBQUEsR0FBQSxPQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsVUFBQSxDQUFBLENBQUEsUUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBO0FBQ0EsSUFBQSxDQUFBLFFBQUEsSUFBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxRQUFBLENBQUEsVUFBQSxDQUFBLENBQUE7QUFDQSxJQUFBLENBQUEsUUFBQSxJQUFBLE9BQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLFdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTs7QUFFQSxhQUFBLENBQUEsWUFBQTtBQUNBLGFBQUEsR0FBQSxLQUFBLENBQUE7SUFDQSxFQUFBLFFBQUEsQ0FBQSxDQUFBO0dBQ0E7O0FBRUEsV0FBQSxVQUFBLEdBQUE7QUFDQSxPQUFBLE9BQUEsS0FBQSxDQUFBLEVBQUEsT0FBQTtBQUNBLFVBQUEsRUFBQSxDQUFBO0FBQ0EsYUFBQSxFQUFBLENBQUE7R0FDQTs7QUFFQSxXQUFBLFlBQUEsR0FBQTtBQUNBLE9BQUEsT0FBQSxLQUFBLFVBQUEsRUFBQSxPQUFBO0FBQ0EsVUFBQSxFQUFBLENBQUE7QUFDQSxhQUFBLEVBQUEsQ0FBQTtHQUNBOztBQUVBLEdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsMkJBQUEsRUFBQSxVQUFBLENBQUEsRUFBQTtBQUNBLE9BQUEsU0FBQSxFQUFBLE9BQUE7QUFDQSxPQUFBLENBQUEsQ0FBQSxhQUFBLENBQUEsVUFBQSxHQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsYUFBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLEVBQUE7QUFDQSxjQUFBLEVBQUEsQ0FBQTtJQUNBLE1BQUE7QUFDQSxnQkFBQSxFQUFBLENBQUE7SUFDQTtHQUNBLENBQUEsQ0FBQTs7QUFFQSxHQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsRUFBQSxDQUFBLFNBQUEsRUFBQSxVQUFBLENBQUEsRUFBQTtBQUNBLE9BQUEsU0FBQSxFQUFBLE9BQUE7QUFDQSxPQUFBLENBQUEsQ0FBQSxLQUFBLEtBQUEsRUFBQSxFQUFBO0FBQ0EsY0FBQSxFQUFBLENBQUE7SUFDQSxNQUFBLElBQUEsQ0FBQSxDQUFBLEtBQUEsS0FBQSxFQUFBLEVBQUE7QUFDQSxnQkFBQSxFQUFBLENBQUE7SUFDQTtHQUNBLENBQUEsQ0FBQTs7QUFFQSxHQUFBLENBQUEsYUFBQSxDQUFBLENBQUEsS0FBQSxDQUFBLFlBQUE7QUFDQSxVQUFBLENBQUEsR0FBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBO0FBQ0EsT0FBQSxTQUFBLEVBQUEsT0FBQTtBQUNBLGVBQUEsRUFBQSxDQUFBO0dBQ0EsQ0FBQSxDQUFBO0VBRUEsQ0FBQSxDQUFBO0NBQ0EsQ0FBQSxDQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ3aW5kb3cuYXBwID0gYW5ndWxhci5tb2R1bGUoJ3BvcnRmb2xpbycsIFsndWkucm91dGVyJ10pO1xuXG5hcHAuY29uZmlnKGZ1bmN0aW9uICgkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyLCAkdXJsTWF0Y2hlckZhY3RvcnlQcm92aWRlcikge1xuXG5cdC8vIHRoaXMgbWFrZXMgdGhlICcvc3RvcmVzLycgcm91dGUgY29ycmVjdGx5IHJlZGlyZWN0IHRvICcvc3RvcmVzJ1xuXHQkdXJsUm91dGVyUHJvdmlkZXIucnVsZShmdW5jdGlvbiAoJGluamVjdG9yLCAkbG9jYXRpb24pIHtcblxuXHRcdHZhciByZSA9IC8oLispKFxcLyspKFxcPy4qKT8kLztcblx0XHR2YXIgcGF0aCA9ICRsb2NhdGlvbi51cmwoKTtcblxuXHRcdGlmKHJlLnRlc3QocGF0aCkpIHtcblx0XHRcdHJldHVybiBwYXRoLnJlcGxhY2UocmUsICckMSQzJyk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9KTtcblx0Ly8gVGhpcyB0dXJucyBvZmYgaGFzaGJhbmcgdXJscyAoLyNhYm91dCkgYW5kIGNoYW5nZXMgaXQgdG8gc29tZXRoaW5nIG5vcm1hbCAoL2Fib3V0KVxuXHQkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG5cdCR1cmxSb3V0ZXJQcm92aWRlci53aGVuKCcvYXV0aC86cHJvdmlkZXInLCBmdW5jdGlvbiAoKSB7XG5cdFx0d2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuXHR9KTtcblx0Ly8gSWYgd2UgZ28gdG8gYSBVUkwgdGhhdCB1aS1yb3V0ZXIgZG9lc24ndCBoYXZlIHJlZ2lzdGVyZWQsIGdvIHRvIHRoZSBcIi9cIiB1cmwuXG5cdCR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbn0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ2Fib3V0Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSl7XG5cdHZhciBpbmNyZW1lbnQgPSAwO1xuXHR2YXIgY2Fyb3VzZWwgPSAkKCcjY2Fyb3VzZWwnKTtcblx0dmFyIGN1cnJlbnQgPSAnI2ZpZy0xJztcblx0dmFyIHByZXY7XG5cdHNldEludGVydmFsKCBmdW5jdGlvbigpe1xuXHRcdGluY3JlbWVudCsrO1xuXHRcdGNhcm91c2VsLmNzcyh7XG5cdFx0XHQnLXdlYmtpdC10cmFuc2Zvcm0nOiAncm90YXRlWCgnICsgKGluY3JlbWVudCAqIC02MCkgKyAnZGVnKSdcblx0XHR9KTtcblx0XHRjYXJvdXNlbC5hdHRyKCdkYXRhLXN0YXRlJywoaW5jcmVtZW50ICUgNikgKyAxKTtcblxuXHRcdHByZXYgPSBjdXJyZW50O1xuXHRcdGN1cnJlbnQgPSAnI2ZpZy0nICsgICsgKChpbmNyZW1lbnQgJSA2KSArIDEpO1xuXHRcdC8vIGNvbnNvbGUubG9nKGN1cnJlbnQpO1xuXHRcdC8vICQoY3VycmVudCkuY3NzKHsnYm9yZGVyLXJhZGl1cycgOiAnMzBweCd9KTtcblx0XHQvLyAkKHByZXYpLmNzcyh7J2JvcmRlci1yYWRpdXMnIDogJzBweCd9KTtcblxuXHR9LDE1MDApO1xufSk7XG4iLCJhcHAuY29udHJvbGxlcignY29udGFjdEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRodHRwKXtcblx0JHNjb3BlLmZvcm1EYXRhID0ge307XG5cblx0JHNjb3BlLnNlbmRNYWlsID0gZnVuY3Rpb24oKXtcblx0XHQkc2NvcGUud2FpdGluZyA9IHRydWU7XG5cdFx0JHNjb3BlLnNlbnQgPSBmYWxzZTtcblx0XHQkc2NvcGUuc3VjY2VzcyA9IGZhbHNlO1xuXHRcdCRodHRwLnBvc3QoJy9hcGkvY29udGFjdCcsICRzY29wZS5mb3JtRGF0YSlcblx0XHQudGhlbihmdW5jdGlvbihzdWNjZXNzUmVzcG9uc2Upe1xuXHRcdFx0Y29uc29sZS5sb2coc3VjY2Vzc1Jlc3BvbnNlKTtcblx0XHRcdCRzY29wZS53YWl0aW5nID0gZmFsc2U7XG5cdFx0XHQkc2NvcGUuc2VudCA9IHRydWU7XG5cdFx0XHQkc2NvcGUuc3VjY2VzcyA9IHN1Y2Nlc3NSZXNwb25zZS5kYXRhO1xuXHRcdFx0JHNjb3BlLmZvcm1EYXRhID0ge307XG5cdFx0fSk7XG5cdH07XG5cblx0dmFyIGNhcmQgPSAkKCcjY2FyZCcpO1xuXHR2YXIgbm90ZSA9ICQoJyNub3RlJyk7XG5cdHZhciB0b2dnbGUgPSB0cnVlO1xuXG5cdGNhcmQuY2xpY2soZnVuY3Rpb24oKXtcblx0XHRpZiAodG9nZ2xlKXtcblx0XHRcdGNhcmQuYWRkQ2xhc3MoJ3NsaWRlUmlnaHQnKTtcblx0XHRcdG5vdGUuY3NzKHsnZGlzcGxheSc6ICdpbml0aWFsJ30pO1xuXHRcdFx0ZXhwbG9kZSgpO1xuXHRcdFx0Y29uc29sZS5sb2coJ2V4cGxvZGVkJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNhcmQucmVtb3ZlQ2xhc3MoJ3NsaWRlUmlnaHQnKTtcblx0XHRcdG5vdGUuY3NzKHsnZGlzcGxheSc6ICdub25lJ30pO1xuXHRcdH1cblx0XHR0b2dnbGUgPSAhdG9nZ2xlO1xuXHR9KTtcblxuXHRmdW5jdGlvbiBleHBsb2RlKCkge1xuXHRcdFx0Ly8gY3LDqWF0aW9uIGQndW4gdGFibGVhdVxuXHRcdHZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNhbnZhc1wiKSxcblx0XHRcdGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpLFxuXHRcdFx0d2lkdGggPSBjYW52YXMud2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCxcblx0XHRcdGhlaWdodCA9IGNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQsXG5cdFx0XHRwYXJ0aWNsZSA9IFtdLFxuXHRcdFx0cGFydGljbGVDb3VudCA9IDAsXG5cdFx0XHRncmF2aXR5ID0gMC4zLFxuXHRcdFx0Y29sb3JzID0gW1xuXHRcdFx0XHQnI2Y0NDMzNicsICcjZTkxZTYzJywgJyM5YzI3YjAnLCAnIzY3M2FiNycsICcjM2Y1MWI1Jyxcblx0XHRcdFx0JyMyMTk2ZjMnLCAnIzAzYTlmNCcsICcjMDBiY2Q0JywgJyMwMDk2ODgnLCAnIzRDQUY1MCcsXG5cdFx0XHRcdCcjOEJDMzRBJywgJyNDRERDMzknLCAnI0ZGRUIzQicsICcjRkZDMTA3JywgJyNGRjk4MDAnLFxuXHRcdFx0XHQnI0ZGNTcyMicsICcjNzk1NTQ4J1xuXHRcdFx0XTtcblxuXHRcdGZvciggdmFyIGkgPSAwOyBpIDwgMzAwOyBpKyspe1xuXHRcdFx0cGFydGljbGUucHVzaCh7XG5cdFx0XHRcdHggOiB3aWR0aC8yLFxuXHRcdFx0XHR5IDogaGVpZ2h0LzIsXG5cdFx0XHRcdGJveFcgOiByYW5kb21SYW5nZSg1LDIwKSxcblx0XHRcdFx0Ym94SCA6IHJhbmRvbVJhbmdlKDUsMjApLFxuXHRcdFx0XHRzaXplIDogcmFuZG9tUmFuZ2UoMiw4KSxcblxuXHRcdFx0XHRzcGlrZXJhbjpyYW5kb21SYW5nZSgzLDUpLFxuXG5cdFx0XHRcdHZlbFggOnJhbmRvbVJhbmdlKC04LDgpLFxuXHRcdFx0XHR2ZWxZIDpyYW5kb21SYW5nZSgtNTAsLTEwKSxcblxuXHRcdFx0XHRhbmdsZSA6Y29udmVydFRvUmFkaWFucyhyYW5kb21SYW5nZSgwLDM2MCkpLFxuXHRcdFx0XHRjb2xvcjpjb2xvcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY29sb3JzLmxlbmd0aCldLFxuXHRcdFx0XHRhbmdsZXNwaW46cmFuZG9tUmFuZ2UoLTAuMiwwLjIpLFxuXG5cdFx0XHRcdGRyYXcgOiBmdW5jdGlvbigpe1xuXHRcdFx0XHRcdGNvbnRleHQuc2F2ZSgpO1xuXHRcdFx0XHRcdGNvbnRleHQudHJhbnNsYXRlKHRoaXMueCx0aGlzLnkpO1xuXHRcdFx0XHRcdGNvbnRleHQucm90YXRlKHRoaXMuYW5nbGUpO1xuXHRcdFx0XHRcdGNvbnRleHQuZmlsbFN0eWxlPXRoaXMuY29sb3I7XG5cdFx0XHRcdFx0Y29udGV4dC5iZWdpblBhdGgoKTtcblx0XHRcdFx0XHQvLyBkcmF3U3RhcigwLCAwLCA1LCB0aGlzLmJveFcsIHRoaXMuYm94SCk7XG5cdFx0XHRcdFx0Y29udGV4dC5maWxsUmVjdCh0aGlzLmJveFcvMiotMSx0aGlzLmJveEgvMiotMSx0aGlzLmJveFcsdGhpcy5ib3hIKTtcblx0XHRcdFx0XHRjb250ZXh0LmZpbGwoKTtcblx0XHRcdFx0XHRjb250ZXh0LmNsb3NlUGF0aCgpO1xuXHRcdFx0XHRcdGNvbnRleHQucmVzdG9yZSgpO1xuXHRcdFx0XHRcdHRoaXMuYW5nbGUgKz0gdGhpcy5hbmdsZXNwaW47XG5cdFx0XHRcdFx0dGhpcy52ZWxZKj0gMC45OTk7XG5cdFx0XHRcdFx0dGhpcy52ZWxZICs9IDAuMztcblx0XHRcdFx0XHR0aGlzLnggKz0gdGhpcy52ZWxYO1xuXHRcdFx0XHRcdHRoaXMueSArPSB0aGlzLnZlbFk7XG5cblx0XHRcdFx0XHRpZih0aGlzLnkgPCAwKXtcblx0XHRcdFx0XHRcdHRoaXMudmVsWSAqPSAtMC4yO1xuXHRcdFx0XHRcdFx0dGhpcy52ZWxYICo9IDAuOTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHRoaXMueSA+IGhlaWdodCl7XG5cdFx0XHRcdFx0XHR0aGlzLmFuZ2xlc3BpbiA9IDA7XG5cdFx0XHRcdFx0XHR0aGlzLnkgPSBoZWlnaHQ7XG5cdFx0XHRcdFx0XHR0aGlzLnZlbFkgKj0gLTAuMjtcblx0XHRcdFx0XHRcdHRoaXMudmVsWCAqPSAwLjk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICh0aGlzLnggPiB3aWR0aCB8fHRoaXMueDwgMCl7XG5cdFx0XHRcdFx0XHR0aGlzLnZlbFggKj0gLTAuNTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fSxcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdHZhciByMT17XG5cdFx0XHR4OndpZHRoLzItMTUwLFxuXHRcdFx0eTpoZWlnaHQvMi0xNTAsXG5cdFx0XHR3aWR0aDozMDAsXG5cdFx0XHRoZWlnaHQ6MzAwLFxuXHRcdFx0dmVsWCA6MCxcblx0XHRcdHZlbFkgOi0xMCxcblx0XHRcdGltZyA6IGxvYWRJbWFnZShcImh0dHA6Ly9pbWFnZS5ub2Vsc2hhY2suY29tL2ZpY2hpZXJzLzIwMTUvMTIvMTQyNzA1MTY0Mi1zbWlsZXkucG5nXCIpLFxuXHRcdFx0YWxwaGF0b3A6MFxuXHRcdH07XG5cblxuXHRcdGZ1bmN0aW9uIGRyYXdTY3JlZW4oKXtcblx0XHRcdHZhciBzaXplID0gNTA7XG5cdFx0XHR2YXIgcEZvbnROYW1lID0gXCJMdWNpZGEgU2FucyBVbmljb2RlXCI7XG5cdFx0XHRjb250ZXh0LmZvbnQgPSBzaXplICsgXCJwdCBcIiArIHBGb250TmFtZTtcblx0XHRcdGNvbnRleHQuZmlsbFRleHQoXCJDb25mZXR0aSBwYXJ0eSAhISFcIiwgd2lkdGgvMiwxNTAgKTtcblx0XHRcdGlmIChyMS5hbHBoYXRvcCA8IDEpe1xuXHRcdFx0XHRyMS5hbHBoYXRvcCArPSAwLjAxO1xuXHRcdFx0fSBlbHNle1xuXHRcdFx0XHRyMS5hbHBoYXRvcCA9IDE7XG5cdFx0XHR9XG5cdFx0XHRjb250ZXh0Lmdsb2JhbEFscGhhID0gcjEuYWxwaGF0b3A7XG5cdFx0XHRjb250ZXh0LmRyYXdJbWFnZShyMS5pbWcscjEueCxyMS55KTtcblx0XHRcdGNvbnRleHQudGV4dEFsaWduID0gJ2NlbnRlcic7XG5cblxuXG5cdFx0XHRpZihyMS5hbHBoYXRvcCA9PT0gMSl7XG5cdFx0XHRcdHIxLnZlbFkqPSAwLjk5OTtcblx0XHRcdFx0cjEudmVsWSArPSAwLjM7XG5cdFx0XHRcdHIxLnggKz0gcjEudmVsWDtcblx0XHRcdFx0cjEueSArPSByMS52ZWxZO1xuXHRcdFx0fVxuXG5cdFx0XHRpZihyMS55ICsgcjEuaGVpZ2h0ID4gaGVpZ2h0KXtcblx0XHRcdFx0cjEuYW5nbGVzcGluID0gMDtcblx0XHRcdFx0cjEueSA9IGhlaWdodCAtIHIxLmhlaWdodDtcblx0XHRcdFx0cjEudmVsWSAqPSAtMC44O1xuXHRcdFx0XHRyMS52ZWxYICo9IDAuOTtcblx0XHRcdH1cblxuXHRcdFx0Y29udGV4dC5nbG9iYWxBbHBoYSA9IDE7XG5cblx0XHRcdGZvciggdmFyIGkgPSAwOyBpIDwgcGFydGljbGUubGVuZ3RoOyBpKyspe1xuXHRcdFx0XHRwYXJ0aWNsZVtpXS5kcmF3KCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gbG9hZEltYWdlKHVybCl7XG5cdFx0XHR2YXIgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcblx0XHRcdGltZy5zcmM9dXJsO1xuXHRcdFx0cmV0dXJuIGltZztcblx0XHR9XG5cblx0XHRmdW5jdGlvbiB1cGRhdGUoKXtcblx0XHRcdGNvbnRleHQuY2xlYXJSZWN0KDAsMCx3aWR0aCxoZWlnaHQpO1xuXHRcdFx0ZHJhd1NjcmVlbigpO1xuXHRcdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKHVwZGF0ZSk7XG5cdFx0fVxuXG5cdFx0dXBkYXRlKCk7XG5cblx0XHRmdW5jdGlvbiByYW5kb21SYW5nZShtaW4sIG1heCl7XG5cdFx0XHRyZXR1cm4gbWluICsgTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiByYW5kb21JbnQobWluLCBtYXgpe1xuXHRcdFx0cmV0dXJuIE1hdGguZmxvb3IobWluICsgTWF0aC5yYW5kb20oKSogKG1heCAtIG1pbiArIDEpKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBjb252ZXJ0VG9SYWRpYW5zKGRlZ3JlZSkge1xuXHRcdFx0cmV0dXJuIGRlZ3JlZSooTWF0aC5QSS8xODApO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGRyYXdTdGFyKGN4LCBjeSwgc3Bpa2VzLCBvdXRlclJhZGl1cywgaW5uZXJSYWRpdXMsY29sb3IpIHtcblx0XHRcdHZhciByb3QgPSBNYXRoLlBJIC8gMiAqIDM7XG5cdFx0XHR2YXIgeCA9IGN4O1xuXHRcdFx0dmFyIHkgPSBjeTtcblx0XHRcdHZhciBzdGVwID0gTWF0aC5QSSAvIHNwaWtlcztcblxuXHRcdFx0Y29udGV4dC5zdHJva2VTeWxlID0gXCIjMDAwXCI7XG5cdFx0XHRjb250ZXh0LmJlZ2luUGF0aCgpO1xuXHRcdFx0Y29udGV4dC5tb3ZlVG8oY3gsIGN5IC0gb3V0ZXJSYWRpdXMpO1xuXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgc3Bpa2VzOyBpKyspIHtcblx0XHRcdFx0eCA9IGN4ICsgTWF0aC5jb3Mocm90KSAqIG91dGVyUmFkaXVzO1xuXHRcdFx0XHR5ID0gY3kgKyBNYXRoLnNpbihyb3QpICogb3V0ZXJSYWRpdXM7XG5cdFx0XHRcdGNvbnRleHQubGluZVRvKHgsIHkpO1xuXHRcdFx0XHRyb3QgKz0gc3RlcDtcblxuXHRcdFx0XHR4ID0gY3ggKyBNYXRoLmNvcyhyb3QpICogaW5uZXJSYWRpdXM7XG5cdFx0XHRcdHkgPSBjeSArIE1hdGguc2luKHJvdCkgKiBpbm5lclJhZGl1cztcblx0XHRcdFx0Y29udGV4dC5saW5lVG8oeCwgeSk7XG5cdFx0XHRcdHJvdCArPSBzdGVwO1xuXHRcdFx0fVxuXG5cdFx0XHRjb250ZXh0LmxpbmVUbyhjeCwgY3kgLSBvdXRlclJhZGl1cyk7XG5cdFx0XHRjb250ZXh0LmNsb3NlUGF0aCgpO1xuXHRcdFx0Y29udGV4dC5maWxsU3R5bGU9Y29sb3I7XG5cdFx0XHRjb250ZXh0LmZpbGwoKTtcblx0XHR9XG5cdH1cblxufSk7XG4iLCJhcHAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcblx0JHN0YXRlUHJvdmlkZXJcblx0LnN0YXRlKCdob21lJywge1xuXHRcdHVybDogJy8nLFxuXHRcdHRlbXBsYXRlVXJsOiAnL2pzL3RlbXBsYXRlcy9ob21lLmh0bWwnXG5cdH0pXG5cdC5zdGF0ZSgncHJvamVjdHMnLCB7XG5cdFx0dXJsOiAnL3Byb2plY3RzJyxcblx0XHR0ZW1wbGF0ZVVybDogJy9qcy90ZW1wbGF0ZXMvcHJvamVjdHMuaHRtbCcsXG5cdFx0Y29udHJvbGxlcjogJ3Byb2plY3RDdHJsJ1xuXHR9KVxuXHQuc3RhdGUoJ2Fib3V0Jywge1xuXHRcdHVybDogJy9hYm91dCcsXG5cdFx0dGVtcGxhdGVVcmw6ICcvanMvdGVtcGxhdGVzL2Fib3V0Lmh0bWwnLFxuXHRcdGNvbnRyb2xsZXI6ICdhYm91dEN0cmwnXG5cdH0pXG5cdC5zdGF0ZSgnY29udGFjdCcsIHtcblx0XHR1cmw6ICcvY29udGFjdCcsXG5cdFx0dGVtcGxhdGVVcmw6ICcvanMvdGVtcGxhdGVzL2NvbnRhY3QuaHRtbCcsXG5cdFx0Y29udHJvbGxlcjogJ2NvbnRhY3RDdHJsJ1xuXHR9KTtcbn0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ3Byb2plY3RDdHJsJywgZnVuY3Rpb24oJHNjb3BlKXtcblx0JChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgY3VyUGFnZSA9IDE7XG5cdFx0dmFyIG51bU9mUGFnZXMgPSAkKFwiLnNrdy1wYWdlXCIpLmxlbmd0aDtcblx0XHR2YXIgYW5pbVRpbWUgPSAxMDAwO1xuXHRcdHZhciBzY3JvbGxpbmcgPSBmYWxzZTtcblx0XHR2YXIgcGdQcmVmaXggPSBcIi5za3ctcGFnZS1cIjtcblxuXHRcdGZ1bmN0aW9uIHBhZ2luYXRpb24oKSB7XG5cdFx0XHRzY3JvbGxpbmcgPSB0cnVlO1xuXG5cdFx0XHQkKHBnUHJlZml4ICsgY3VyUGFnZSkucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblx0XHRcdCQocGdQcmVmaXggKyAoY3VyUGFnZSAtIDEpKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xuXHRcdFx0JChwZ1ByZWZpeCArIChjdXJQYWdlICsgMSkpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzY3JvbGxpbmcgPSBmYWxzZTtcblx0XHRcdH0sIGFuaW1UaW1lKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBuYXZpZ2F0ZVVwKCkge1xuXHRcdFx0aWYgKGN1clBhZ2UgPT09IDEpIHJldHVybjtcblx0XHRcdGN1clBhZ2UtLTtcblx0XHRcdHBhZ2luYXRpb24oKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBuYXZpZ2F0ZURvd24oKSB7XG5cdFx0XHRpZiAoY3VyUGFnZSA9PT0gbnVtT2ZQYWdlcykgcmV0dXJuO1xuXHRcdFx0Y3VyUGFnZSsrO1xuXHRcdFx0cGFnaW5hdGlvbigpO1xuXHRcdH1cblxuXHRcdCQoZG9jdW1lbnQpLm9uKFwibW91c2V3aGVlbCBET01Nb3VzZVNjcm9sbFwiLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRpZiAoc2Nyb2xsaW5nKSByZXR1cm47XG5cdFx0XHRpZiAoZS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGEgPiAwIHx8IGUub3JpZ2luYWxFdmVudC5kZXRhaWwgPCAwKSB7XG5cdFx0XHRcdG5hdmlnYXRlVXAoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5hdmlnYXRlRG93bigpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0JChkb2N1bWVudCkub24oXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdGlmIChzY3JvbGxpbmcpIHJldHVybjtcblx0XHRcdGlmIChlLndoaWNoID09PSAzOCkge1xuXHRcdFx0XHRuYXZpZ2F0ZVVwKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGUud2hpY2ggPT09IDQwKSB7XG5cdFx0XHRcdG5hdmlnYXRlRG93bigpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0JCgnI2Rvd24tYXJyb3cnKS5jbGljayhmdW5jdGlvbigpe1xuXHRcdFx0Y29uc29sZS5sb2coJ2NsaWNrZWQnKTtcblx0XHRcdGlmIChzY3JvbGxpbmcpIHJldHVybjtcblx0XHRcdG5hdmlnYXRlRG93bigpO1xuXHRcdH0pO1xuXG5cdH0pO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
