'use strict';

window.app = angular.module('portfolio', ['ui.router']);

app.config(function ($urlRouterProvider, $locationProvider, $urlMatcherFactoryProvider) {

	// this makes the '/stores/' route correctly redirect to '/stores'
	$urlRouterProvider.rule(function ($injector, $location) {

		var re = /(.+)(\/+)(\?.*)?$/;
		var path = $location.url();

		if (re.test(path)) {
			return path.replace(re, '$1$3');
		}

		return false;
	});
	// This turns off hashbang urls (/#about) and changes it to something normal (/about)
	$locationProvider.html5Mode(true);
	$urlRouterProvider.when('/auth/:provider', function () {
		window.location.reload();
	});
	// If we go to a URL that ui-router doesn't have registered, go to the "/" url.
	$urlRouterProvider.otherwise('/');
});

app.controller('aboutCtrl', function ($scope) {
	var increment = 0;
	var carousel = $('#carousel');
	var current = '#fig-1';
	var prev;
	setInterval(function () {
		increment++;
		carousel.css({
			'-webkit-transform': 'rotateX(' + increment * -60 + 'deg)'
		});
		carousel.attr('data-state', increment % 6 + 1);

		prev = current;
		current = '#fig-' + +(increment % 6 + 1);
		// console.log(current);
		// $(current).css({'border-radius' : '30px'});
		// $(prev).css({'border-radius' : '0px'});
	}, 1500);

	var circle1 = $('#circle-1');
	console.log('$circle-1', circle1);
	var circle2 = $('#circle-2');
	// var circle3 = $('#circle-3');

	circle1.click(function () {
		circle1.addClass('spin-clockwise');
		setTimeout(function () {
			circle2.addClass('spin-counterclockwise');
		}, 500);
	});
});

app.controller('contactCtrl', function ($scope, $http) {
	$scope.formData = {};

	$scope.sendMail = function () {
		$scope.waiting = true;
		$scope.sent = false;
		$scope.success = false;
		$http.post('/api/contact', $scope.formData).then(function (successResponse) {
			console.log(successResponse);
			$scope.waiting = false;
			$scope.sent = true;
			$scope.success = successResponse.data;
			$scope.formData = {};
		});
	};

	var card = $('#card');
	var note = $('.note');
	var toggle = true;

	card.click(function () {
		if (toggle) {
			card.removeClass('hidden');
			card.removeClass('initial');
			card.addClass('visible');
			note.css({ 'display': 'initial' });
			// explode();
			// console.log('exploded');
		} else {
				card.removeClass('visible');
				card.addClass('hidden');
				note.css({ 'display': 'none' });
			}
		toggle = !toggle;
	});

	function explode() {
		// cr√©ation d'un tableau
		var canvas = document.getElementById("canvas"),
		    context = canvas.getContext("2d"),
		    width = canvas.width = window.innerWidth,
		    height = canvas.height = window.innerHeight,
		    particle = [],
		    particleCount = 0,
		    gravity = 0.3,
		    colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4CAF50', '#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800', '#FF5722', '#795548'];

		for (var i = 0; i < 300; i++) {
			particle.push({
				x: width / 2,
				y: height / 2,
				boxW: randomRange(5, 20),
				boxH: randomRange(5, 20),
				size: randomRange(2, 8),

				spikeran: randomRange(3, 5),

				velX: randomRange(-8, 8),
				velY: randomRange(-50, -10),

				angle: convertToRadians(randomRange(0, 360)),
				color: colors[Math.floor(Math.random() * colors.length)],
				anglespin: randomRange(-0.2, 0.2),

				draw: function draw() {
					context.save();
					context.translate(this.x, this.y);
					context.rotate(this.angle);
					context.fillStyle = this.color;
					context.beginPath();
					// drawStar(0, 0, 5, this.boxW, this.boxH);
					context.fillRect(this.boxW / 2 * -1, this.boxH / 2 * -1, this.boxW, this.boxH);
					context.fill();
					context.closePath();
					context.restore();
					this.angle += this.anglespin;
					this.velY *= 0.999;
					this.velY += 0.3;
					this.x += this.velX;
					this.y += this.velY;

					if (this.y < 0) {
						this.velY *= -0.2;
						this.velX *= 0.9;
					}
					if (this.y > height) {
						this.anglespin = 0;
						this.y = height;
						this.velY *= -0.2;
						this.velX *= 0.9;
					}
					if (this.x > width || this.x < 0) {
						this.velX *= -0.5;
					}
				}
			});
		}

		var r1 = {
			x: width / 2 - 150,
			y: height / 2 - 150,
			width: 300,
			height: 300,
			velX: 0,
			velY: -10,
			img: loadImage("http://image.noelshack.com/fichiers/2015/12/1427051642-smiley.png"),
			alphatop: 0
		};

		function drawScreen() {
			var size = 50;
			var pFontName = "Lucida Sans Unicode";
			context.font = size + "pt " + pFontName;
			context.fillText("Confetti party !!!", width / 2, 150);
			if (r1.alphatop < 1) {
				r1.alphatop += 0.01;
			} else {
				r1.alphatop = 1;
			}
			context.globalAlpha = r1.alphatop;
			context.drawImage(r1.img, r1.x, r1.y);
			context.textAlign = 'center';

			if (r1.alphatop === 1) {
				r1.velY *= 0.999;
				r1.velY += 0.3;
				r1.x += r1.velX;
				r1.y += r1.velY;
			}

			if (r1.y + r1.height > height) {
				r1.anglespin = 0;
				r1.y = height - r1.height;
				r1.velY *= -0.8;
				r1.velX *= 0.9;
			}

			context.globalAlpha = 1;

			for (var i = 0; i < particle.length; i++) {
				particle[i].draw();
			}
		}

		function loadImage(url) {
			var img = document.createElement("img");
			img.src = url;
			return img;
		}

		function update() {
			context.clearRect(0, 0, width, height);
			drawScreen();
			requestAnimationFrame(update);
		}

		update();

		function randomRange(min, max) {
			return min + Math.random() * (max - min);
		}

		function randomInt(min, max) {
			return Math.floor(min + Math.random() * (max - min + 1));
		}

		function convertToRadians(degree) {
			return degree * (Math.PI / 180);
		}

		function drawStar(cx, cy, spikes, outerRadius, innerRadius, color) {
			var rot = Math.PI / 2 * 3;
			var x = cx;
			var y = cy;
			var step = Math.PI / spikes;

			context.strokeSyle = "#000";
			context.beginPath();
			context.moveTo(cx, cy - outerRadius);

			for (i = 0; i < spikes; i++) {
				x = cx + Math.cos(rot) * outerRadius;
				y = cy + Math.sin(rot) * outerRadius;
				context.lineTo(x, y);
				rot += step;

				x = cx + Math.cos(rot) * innerRadius;
				y = cy + Math.sin(rot) * innerRadius;
				context.lineTo(x, y);
				rot += step;
			}

			context.lineTo(cx, cy - outerRadius);
			context.closePath();
			context.fillStyle = color;
			context.fill();
		}
	}
});

app.config(function ($stateProvider) {
	$stateProvider.state('home', {
		url: '/',
		templateUrl: '/js/templates/home.html'
	}).state('projects', {
		url: '/projects',
		templateUrl: '/js/templates/projects.html',
		controller: 'projectCtrl'
	}).state('about', {
		url: '/about',
		templateUrl: '/js/templates/about.html',
		controller: 'aboutCtrl'
	}).state('contact', {
		url: '/contact',
		templateUrl: '/js/templates/contact.html',
		controller: 'contactCtrl'
	});
});

app.controller('projectCtrl', function ($scope) {
	$(document).ready(function () {

		var curPage = 1;
		var numOfPages = $(".skw-page").length;
		var animTime = 1000;
		var scrolling = false;
		var pgPrefix = ".skw-page-";

		function pagination() {
			scrolling = true;

			$(pgPrefix + curPage).removeClass("inactive").addClass("active");
			$(pgPrefix + (curPage - 1)).addClass("inactive");
			$(pgPrefix + (curPage + 1)).removeClass("active");

			setTimeout(function () {
				scrolling = false;
			}, animTime);
		}

		function navigateUp() {
			if (curPage === 1) return;
			curPage--;
			pagination();
		}

		function navigateDown() {
			if (curPage === numOfPages) return;
			curPage++;
			pagination();
		}

		$(document).on("mousewheel DOMMouseScroll", function (e) {
			if (scrolling) return;
			if (e.originalEvent.wheelDelta > 0 || e.originalEvent.detail < 0) {
				navigateUp();
			} else {
				navigateDown();
			}
		});

		$(document).on("keydown", function (e) {
			if (scrolling) return;
			if (e.which === 38) {
				navigateUp();
			} else if (e.which === 40) {
				navigateDown();
			}
		});

		$('#down-arrow').click(function () {
			console.log('clicked');
			if (scrolling) return;
			navigateDown();
		});
	});
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImFib3V0LmpzIiwiY29udGFjdC5qcyIsImhvbWUuanMiLCJwcm9qZWN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBQSxDQUFBLEdBQUEsR0FBQSxPQUFBLENBQUEsTUFBQSxDQUFBLFdBQUEsRUFBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBLENBQUE7O0FBRUEsR0FBQSxDQUFBLE1BQUEsQ0FBQSxVQUFBLGtCQUFBLEVBQUEsaUJBQUEsRUFBQSwwQkFBQSxFQUFBOzs7QUFHQSxtQkFBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLFNBQUEsRUFBQSxTQUFBLEVBQUE7O0FBRUEsTUFBQSxFQUFBLEdBQUEsbUJBQUEsQ0FBQTtBQUNBLE1BQUEsSUFBQSxHQUFBLFNBQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQTs7QUFFQSxNQUFBLEVBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLEVBQUE7QUFDQSxVQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsRUFBQSxFQUFBLE1BQUEsQ0FBQSxDQUFBO0dBQ0E7O0FBRUEsU0FBQSxLQUFBLENBQUE7RUFDQSxDQUFBOztBQUFBLEFBRUEsa0JBQUEsQ0FBQSxTQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7QUFDQSxtQkFBQSxDQUFBLElBQUEsQ0FBQSxpQkFBQSxFQUFBLFlBQUE7QUFDQSxRQUFBLENBQUEsUUFBQSxDQUFBLE1BQUEsRUFBQSxDQUFBO0VBQ0EsQ0FBQTs7QUFBQSxBQUVBLG1CQUFBLENBQUEsU0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO0NBQ0EsQ0FBQSxDQUFBOztBQ3ZCQSxHQUFBLENBQUEsVUFBQSxDQUFBLFdBQUEsRUFBQSxVQUFBLE1BQUEsRUFBQTtBQUNBLEtBQUEsU0FBQSxHQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsUUFBQSxHQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsT0FBQSxHQUFBLFFBQUEsQ0FBQTtBQUNBLEtBQUEsSUFBQSxDQUFBO0FBQ0EsWUFBQSxDQUFBLFlBQUE7QUFDQSxXQUFBLEVBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxHQUFBLENBQUE7QUFDQSxzQkFBQSxFQUFBLFVBQUEsR0FBQSxTQUFBLEdBQUEsQ0FBQSxFQUFBLEdBQUEsTUFBQTtHQUNBLENBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxJQUFBLENBQUEsWUFBQSxFQUFBLFNBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUE7O0FBRUEsTUFBQSxHQUFBLE9BQUEsQ0FBQTtBQUNBLFNBQUEsR0FBQSxPQUFBLEdBQUEsRUFBQSxTQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTs7OztFQUtBLEVBQUEsSUFBQSxDQUFBLENBQUE7QUFMQTtBQU9BLEtBQUEsT0FBQSxHQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQTtBQUNBLFFBQUEsQ0FBQSxHQUFBLENBQUEsV0FBQSxFQUFBLE9BQUEsQ0FBQSxDQUFBO0FBQ0EsS0FBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBLFdBQUEsQ0FBQTs7O0FBQUEsQUFHQSxRQUFBLENBQUEsS0FBQSxDQUFBLFlBQUE7QUFDQSxTQUFBLENBQUEsUUFBQSxDQUFBLGdCQUFBLENBQUEsQ0FBQTtBQUNBLFlBQUEsQ0FBQSxZQUFBO0FBQ0EsVUFBQSxDQUFBLFFBQUEsQ0FBQSx1QkFBQSxDQUFBLENBQUE7R0FDQSxFQUFBLEdBQUEsQ0FBQSxDQUFBO0VBQ0EsQ0FBQSxDQUFBO0NBQ0EsQ0FBQSxDQUFBOztBQy9CQSxHQUFBLENBQUEsVUFBQSxDQUFBLGFBQUEsRUFBQSxVQUFBLE1BQUEsRUFBQSxLQUFBLEVBQUE7QUFDQSxPQUFBLENBQUEsUUFBQSxHQUFBLEVBQUEsQ0FBQTs7QUFFQSxPQUFBLENBQUEsUUFBQSxHQUFBLFlBQUE7QUFDQSxRQUFBLENBQUEsT0FBQSxHQUFBLElBQUEsQ0FBQTtBQUNBLFFBQUEsQ0FBQSxJQUFBLEdBQUEsS0FBQSxDQUFBO0FBQ0EsUUFBQSxDQUFBLE9BQUEsR0FBQSxLQUFBLENBQUE7QUFDQSxPQUFBLENBQUEsSUFBQSxDQUFBLGNBQUEsRUFBQSxNQUFBLENBQUEsUUFBQSxDQUFBLENBQ0EsSUFBQSxDQUFBLFVBQUEsZUFBQSxFQUFBO0FBQ0EsVUFBQSxDQUFBLEdBQUEsQ0FBQSxlQUFBLENBQUEsQ0FBQTtBQUNBLFNBQUEsQ0FBQSxPQUFBLEdBQUEsS0FBQSxDQUFBO0FBQ0EsU0FBQSxDQUFBLElBQUEsR0FBQSxJQUFBLENBQUE7QUFDQSxTQUFBLENBQUEsT0FBQSxHQUFBLGVBQUEsQ0FBQSxJQUFBLENBQUE7QUFDQSxTQUFBLENBQUEsUUFBQSxHQUFBLEVBQUEsQ0FBQTtHQUNBLENBQUEsQ0FBQTtFQUNBLENBQUE7O0FBRUEsS0FBQSxJQUFBLEdBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBO0FBQ0EsS0FBQSxJQUFBLEdBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBO0FBQ0EsS0FBQSxNQUFBLEdBQUEsSUFBQSxDQUFBOztBQUVBLEtBQUEsQ0FBQSxLQUFBLENBQUEsWUFBQTtBQUNBLE1BQUEsTUFBQSxFQUFBO0FBQ0EsT0FBQSxDQUFBLFdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtBQUNBLE9BQUEsQ0FBQSxXQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7QUFDQSxPQUFBLENBQUEsUUFBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBO0FBQ0EsT0FBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLFNBQUEsRUFBQSxTQUFBLEVBQUEsQ0FBQTs7O0FBQUEsR0FHQSxNQUFBO0FBQ0EsUUFBQSxDQUFBLFdBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQTtBQUNBLFFBQUEsQ0FBQSxRQUFBLENBQUEsUUFBQSxDQUFBLENBQUE7QUFDQSxRQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsU0FBQSxFQUFBLE1BQUEsRUFBQSxDQUFBLENBQUE7SUFDQTtBQUNBLFFBQUEsR0FBQSxDQUFBLE1BQUEsQ0FBQTtFQUNBLENBQUEsQ0FBQTs7QUFFQSxVQUFBLE9BQUEsR0FBQTs7QUFFQSxNQUFBLE1BQUEsR0FBQSxRQUFBLENBQUEsY0FBQSxDQUFBLFFBQUEsQ0FBQTtNQUNBLE9BQUEsR0FBQSxNQUFBLENBQUEsVUFBQSxDQUFBLElBQUEsQ0FBQTtNQUNBLEtBQUEsR0FBQSxNQUFBLENBQUEsS0FBQSxHQUFBLE1BQUEsQ0FBQSxVQUFBO01BQ0EsTUFBQSxHQUFBLE1BQUEsQ0FBQSxNQUFBLEdBQUEsTUFBQSxDQUFBLFdBQUE7TUFDQSxRQUFBLEdBQUEsRUFBQTtNQUNBLGFBQUEsR0FBQSxDQUFBO01BQ0EsT0FBQSxHQUFBLEdBQUE7TUFDQSxNQUFBLEdBQUEsQ0FDQSxTQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsRUFBQSxTQUFBLEVBQUEsU0FBQSxFQUNBLFNBQUEsRUFBQSxTQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsRUFBQSxTQUFBLEVBQ0EsU0FBQSxFQUFBLFNBQUEsRUFBQSxTQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsRUFDQSxTQUFBLEVBQUEsU0FBQSxDQUNBLENBQUE7O0FBRUEsT0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLEdBQUEsRUFBQSxDQUFBLEVBQUEsRUFBQTtBQUNBLFdBQUEsQ0FBQSxJQUFBLENBQUE7QUFDQSxLQUFBLEVBQUEsS0FBQSxHQUFBLENBQUE7QUFDQSxLQUFBLEVBQUEsTUFBQSxHQUFBLENBQUE7QUFDQSxRQUFBLEVBQUEsV0FBQSxDQUFBLENBQUEsRUFBQSxFQUFBLENBQUE7QUFDQSxRQUFBLEVBQUEsV0FBQSxDQUFBLENBQUEsRUFBQSxFQUFBLENBQUE7QUFDQSxRQUFBLEVBQUEsV0FBQSxDQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7O0FBRUEsWUFBQSxFQUFBLFdBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBOztBQUVBLFFBQUEsRUFBQSxXQUFBLENBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBO0FBQ0EsUUFBQSxFQUFBLFdBQUEsQ0FBQSxDQUFBLEVBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQTs7QUFFQSxTQUFBLEVBQUEsZ0JBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQSxFQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQ0EsU0FBQSxFQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLEVBQUEsR0FBQSxNQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7QUFDQSxhQUFBLEVBQUEsV0FBQSxDQUFBLENBQUEsR0FBQSxFQUFBLEdBQUEsQ0FBQTs7QUFFQSxRQUFBLEVBQUEsZ0JBQUE7QUFDQSxZQUFBLENBQUEsSUFBQSxFQUFBLENBQUE7QUFDQSxZQUFBLENBQUEsU0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLEVBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO0FBQ0EsWUFBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7QUFDQSxZQUFBLENBQUEsU0FBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUE7QUFDQSxZQUFBLENBQUEsU0FBQSxFQUFBOztBQUFBLEFBRUEsWUFBQSxDQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxHQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsRUFBQSxJQUFBLENBQUEsSUFBQSxHQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsRUFBQSxJQUFBLENBQUEsSUFBQSxFQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtBQUNBLFlBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtBQUNBLFlBQUEsQ0FBQSxTQUFBLEVBQUEsQ0FBQTtBQUNBLFlBQUEsQ0FBQSxPQUFBLEVBQUEsQ0FBQTtBQUNBLFNBQUEsQ0FBQSxLQUFBLElBQUEsSUFBQSxDQUFBLFNBQUEsQ0FBQTtBQUNBLFNBQUEsQ0FBQSxJQUFBLElBQUEsS0FBQSxDQUFBO0FBQ0EsU0FBQSxDQUFBLElBQUEsSUFBQSxHQUFBLENBQUE7QUFDQSxTQUFBLENBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxJQUFBLENBQUE7QUFDQSxTQUFBLENBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxJQUFBLENBQUE7O0FBRUEsU0FBQSxJQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsRUFBQTtBQUNBLFVBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxHQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsSUFBQSxJQUFBLEdBQUEsQ0FBQTtNQUNBO0FBQ0EsU0FBQSxJQUFBLENBQUEsQ0FBQSxHQUFBLE1BQUEsRUFBQTtBQUNBLFVBQUEsQ0FBQSxTQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLENBQUEsR0FBQSxNQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsSUFBQSxJQUFBLENBQUEsR0FBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLElBQUEsSUFBQSxHQUFBLENBQUE7TUFDQTtBQUNBLFNBQUEsSUFBQSxDQUFBLENBQUEsR0FBQSxLQUFBLElBQUEsSUFBQSxDQUFBLENBQUEsR0FBQSxDQUFBLEVBQUE7QUFDQSxVQUFBLENBQUEsSUFBQSxJQUFBLENBQUEsR0FBQSxDQUFBO01BQ0E7S0FFQTtJQUNBLENBQUEsQ0FBQTtHQUNBOztBQUVBLE1BQUEsRUFBQSxHQUFBO0FBQ0EsSUFBQSxFQUFBLEtBQUEsR0FBQSxDQUFBLEdBQUEsR0FBQTtBQUNBLElBQUEsRUFBQSxNQUFBLEdBQUEsQ0FBQSxHQUFBLEdBQUE7QUFDQSxRQUFBLEVBQUEsR0FBQTtBQUNBLFNBQUEsRUFBQSxHQUFBO0FBQ0EsT0FBQSxFQUFBLENBQUE7QUFDQSxPQUFBLEVBQUEsQ0FBQSxFQUFBO0FBQ0EsTUFBQSxFQUFBLFNBQUEsQ0FBQSxtRUFBQSxDQUFBO0FBQ0EsV0FBQSxFQUFBLENBQUE7R0FDQSxDQUFBOztBQUdBLFdBQUEsVUFBQSxHQUFBO0FBQ0EsT0FBQSxJQUFBLEdBQUEsRUFBQSxDQUFBO0FBQ0EsT0FBQSxTQUFBLEdBQUEscUJBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxJQUFBLEdBQUEsSUFBQSxHQUFBLEtBQUEsR0FBQSxTQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsUUFBQSxDQUFBLG9CQUFBLEVBQUEsS0FBQSxHQUFBLENBQUEsRUFBQSxHQUFBLENBQUEsQ0FBQTtBQUNBLE9BQUEsRUFBQSxDQUFBLFFBQUEsR0FBQSxDQUFBLEVBQUE7QUFDQSxNQUFBLENBQUEsUUFBQSxJQUFBLElBQUEsQ0FBQTtJQUNBLE1BQUE7QUFDQSxNQUFBLENBQUEsUUFBQSxHQUFBLENBQUEsQ0FBQTtJQUNBO0FBQ0EsVUFBQSxDQUFBLFdBQUEsR0FBQSxFQUFBLENBQUEsUUFBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLFNBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxFQUFBLEVBQUEsQ0FBQSxDQUFBLEVBQUEsRUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLFNBQUEsR0FBQSxRQUFBLENBQUE7O0FBSUEsT0FBQSxFQUFBLENBQUEsUUFBQSxLQUFBLENBQUEsRUFBQTtBQUNBLE1BQUEsQ0FBQSxJQUFBLElBQUEsS0FBQSxDQUFBO0FBQ0EsTUFBQSxDQUFBLElBQUEsSUFBQSxHQUFBLENBQUE7QUFDQSxNQUFBLENBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQSxJQUFBLENBQUE7QUFDQSxNQUFBLENBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQSxJQUFBLENBQUE7SUFDQTs7QUFFQSxPQUFBLEVBQUEsQ0FBQSxDQUFBLEdBQUEsRUFBQSxDQUFBLE1BQUEsR0FBQSxNQUFBLEVBQUE7QUFDQSxNQUFBLENBQUEsU0FBQSxHQUFBLENBQUEsQ0FBQTtBQUNBLE1BQUEsQ0FBQSxDQUFBLEdBQUEsTUFBQSxHQUFBLEVBQUEsQ0FBQSxNQUFBLENBQUE7QUFDQSxNQUFBLENBQUEsSUFBQSxJQUFBLENBQUEsR0FBQSxDQUFBO0FBQ0EsTUFBQSxDQUFBLElBQUEsSUFBQSxHQUFBLENBQUE7SUFDQTs7QUFFQSxVQUFBLENBQUEsV0FBQSxHQUFBLENBQUEsQ0FBQTs7QUFFQSxRQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsRUFBQSxDQUFBLEdBQUEsUUFBQSxDQUFBLE1BQUEsRUFBQSxDQUFBLEVBQUEsRUFBQTtBQUNBLFlBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtJQUNBO0dBQ0E7O0FBRUEsV0FBQSxTQUFBLENBQUEsR0FBQSxFQUFBO0FBQ0EsT0FBQSxHQUFBLEdBQUEsUUFBQSxDQUFBLGFBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQTtBQUNBLE1BQUEsQ0FBQSxHQUFBLEdBQUEsR0FBQSxDQUFBO0FBQ0EsVUFBQSxHQUFBLENBQUE7R0FDQTs7QUFFQSxXQUFBLE1BQUEsR0FBQTtBQUNBLFVBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxLQUFBLEVBQUEsTUFBQSxDQUFBLENBQUE7QUFDQSxhQUFBLEVBQUEsQ0FBQTtBQUNBLHdCQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7R0FDQTs7QUFFQSxRQUFBLEVBQUEsQ0FBQTs7QUFFQSxXQUFBLFdBQUEsQ0FBQSxHQUFBLEVBQUEsR0FBQSxFQUFBO0FBQ0EsVUFBQSxHQUFBLEdBQUEsSUFBQSxDQUFBLE1BQUEsRUFBQSxJQUFBLEdBQUEsR0FBQSxHQUFBLENBQUEsQ0FBQTtHQUNBOztBQUVBLFdBQUEsU0FBQSxDQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUE7QUFDQSxVQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsR0FBQSxHQUFBLElBQUEsQ0FBQSxNQUFBLEVBQUEsSUFBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7R0FDQTs7QUFFQSxXQUFBLGdCQUFBLENBQUEsTUFBQSxFQUFBO0FBQ0EsVUFBQSxNQUFBLElBQUEsSUFBQSxDQUFBLEVBQUEsR0FBQSxHQUFBLENBQUEsQ0FBQTtHQUNBOztBQUVBLFdBQUEsUUFBQSxDQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsTUFBQSxFQUFBLFdBQUEsRUFBQSxXQUFBLEVBQUEsS0FBQSxFQUFBO0FBQ0EsT0FBQSxHQUFBLEdBQUEsSUFBQSxDQUFBLEVBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQ0EsT0FBQSxDQUFBLEdBQUEsRUFBQSxDQUFBO0FBQ0EsT0FBQSxDQUFBLEdBQUEsRUFBQSxDQUFBO0FBQ0EsT0FBQSxJQUFBLEdBQUEsSUFBQSxDQUFBLEVBQUEsR0FBQSxNQUFBLENBQUE7O0FBRUEsVUFBQSxDQUFBLFVBQUEsR0FBQSxNQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsU0FBQSxFQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsTUFBQSxDQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsV0FBQSxDQUFBLENBQUE7O0FBRUEsUUFBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxNQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUE7QUFDQSxLQUFBLEdBQUEsRUFBQSxHQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsV0FBQSxDQUFBO0FBQ0EsS0FBQSxHQUFBLEVBQUEsR0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxHQUFBLFdBQUEsQ0FBQTtBQUNBLFdBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO0FBQ0EsT0FBQSxJQUFBLElBQUEsQ0FBQTs7QUFFQSxLQUFBLEdBQUEsRUFBQSxHQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsV0FBQSxDQUFBO0FBQ0EsS0FBQSxHQUFBLEVBQUEsR0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxHQUFBLFdBQUEsQ0FBQTtBQUNBLFdBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO0FBQ0EsT0FBQSxJQUFBLElBQUEsQ0FBQTtJQUNBOztBQUVBLFVBQUEsQ0FBQSxNQUFBLENBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxXQUFBLENBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxTQUFBLEVBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxTQUFBLEdBQUEsS0FBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLElBQUEsRUFBQSxDQUFBO0dBQ0E7RUFDQTtDQUVBLENBQUEsQ0FBQTs7QUNqTkEsR0FBQSxDQUFBLE1BQUEsQ0FBQSxVQUFBLGNBQUEsRUFBQTtBQUNBLGVBQUEsQ0FDQSxLQUFBLENBQUEsTUFBQSxFQUFBO0FBQ0EsS0FBQSxFQUFBLEdBQUE7QUFDQSxhQUFBLEVBQUEseUJBQUE7RUFDQSxDQUFBLENBQ0EsS0FBQSxDQUFBLFVBQUEsRUFBQTtBQUNBLEtBQUEsRUFBQSxXQUFBO0FBQ0EsYUFBQSxFQUFBLDZCQUFBO0FBQ0EsWUFBQSxFQUFBLGFBQUE7RUFDQSxDQUFBLENBQ0EsS0FBQSxDQUFBLE9BQUEsRUFBQTtBQUNBLEtBQUEsRUFBQSxRQUFBO0FBQ0EsYUFBQSxFQUFBLDBCQUFBO0FBQ0EsWUFBQSxFQUFBLFdBQUE7RUFDQSxDQUFBLENBQ0EsS0FBQSxDQUFBLFNBQUEsRUFBQTtBQUNBLEtBQUEsRUFBQSxVQUFBO0FBQ0EsYUFBQSxFQUFBLDRCQUFBO0FBQ0EsWUFBQSxFQUFBLGFBQUE7RUFDQSxDQUFBLENBQUE7Q0FDQSxDQUFBLENBQUE7O0FDckJBLEdBQUEsQ0FBQSxVQUFBLENBQUEsYUFBQSxFQUFBLFVBQUEsTUFBQSxFQUFBO0FBQ0EsRUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQSxZQUFBOztBQUVBLE1BQUEsT0FBQSxHQUFBLENBQUEsQ0FBQTtBQUNBLE1BQUEsVUFBQSxHQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQSxNQUFBLENBQUE7QUFDQSxNQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7QUFDQSxNQUFBLFNBQUEsR0FBQSxLQUFBLENBQUE7QUFDQSxNQUFBLFFBQUEsR0FBQSxZQUFBLENBQUE7O0FBRUEsV0FBQSxVQUFBLEdBQUE7QUFDQSxZQUFBLEdBQUEsSUFBQSxDQUFBOztBQUVBLElBQUEsQ0FBQSxRQUFBLEdBQUEsT0FBQSxDQUFBLENBQUEsV0FBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtBQUNBLElBQUEsQ0FBQSxRQUFBLElBQUEsT0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsUUFBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBO0FBQ0EsSUFBQSxDQUFBLFFBQUEsSUFBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsUUFBQSxDQUFBLENBQUE7O0FBRUEsYUFBQSxDQUFBLFlBQUE7QUFDQSxhQUFBLEdBQUEsS0FBQSxDQUFBO0lBQ0EsRUFBQSxRQUFBLENBQUEsQ0FBQTtHQUNBOztBQUVBLFdBQUEsVUFBQSxHQUFBO0FBQ0EsT0FBQSxPQUFBLEtBQUEsQ0FBQSxFQUFBLE9BQUE7QUFDQSxVQUFBLEVBQUEsQ0FBQTtBQUNBLGFBQUEsRUFBQSxDQUFBO0dBQ0E7O0FBRUEsV0FBQSxZQUFBLEdBQUE7QUFDQSxPQUFBLE9BQUEsS0FBQSxVQUFBLEVBQUEsT0FBQTtBQUNBLFVBQUEsRUFBQSxDQUFBO0FBQ0EsYUFBQSxFQUFBLENBQUE7R0FDQTs7QUFFQSxHQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsRUFBQSxDQUFBLDJCQUFBLEVBQUEsVUFBQSxDQUFBLEVBQUE7QUFDQSxPQUFBLFNBQUEsRUFBQSxPQUFBO0FBQ0EsT0FBQSxDQUFBLENBQUEsYUFBQSxDQUFBLFVBQUEsR0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLGFBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxFQUFBO0FBQ0EsY0FBQSxFQUFBLENBQUE7SUFDQSxNQUFBO0FBQ0EsZ0JBQUEsRUFBQSxDQUFBO0lBQ0E7R0FDQSxDQUFBLENBQUE7O0FBRUEsR0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxTQUFBLEVBQUEsVUFBQSxDQUFBLEVBQUE7QUFDQSxPQUFBLFNBQUEsRUFBQSxPQUFBO0FBQ0EsT0FBQSxDQUFBLENBQUEsS0FBQSxLQUFBLEVBQUEsRUFBQTtBQUNBLGNBQUEsRUFBQSxDQUFBO0lBQ0EsTUFBQSxJQUFBLENBQUEsQ0FBQSxLQUFBLEtBQUEsRUFBQSxFQUFBO0FBQ0EsZ0JBQUEsRUFBQSxDQUFBO0lBQ0E7R0FDQSxDQUFBLENBQUE7O0FBRUEsR0FBQSxDQUFBLGFBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQSxZQUFBO0FBQ0EsVUFBQSxDQUFBLEdBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQTtBQUNBLE9BQUEsU0FBQSxFQUFBLE9BQUE7QUFDQSxlQUFBLEVBQUEsQ0FBQTtHQUNBLENBQUEsQ0FBQTtFQUVBLENBQUEsQ0FBQTtDQUNBLENBQUEsQ0FBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsid2luZG93LmFwcCA9IGFuZ3VsYXIubW9kdWxlKCdwb3J0Zm9saW8nLCBbJ3VpLnJvdXRlciddKTtcblxuYXBwLmNvbmZpZyhmdW5jdGlvbiAoJHVybFJvdXRlclByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlciwgJHVybE1hdGNoZXJGYWN0b3J5UHJvdmlkZXIpIHtcblxuXHQvLyB0aGlzIG1ha2VzIHRoZSAnL3N0b3Jlcy8nIHJvdXRlIGNvcnJlY3RseSByZWRpcmVjdCB0byAnL3N0b3Jlcydcblx0JHVybFJvdXRlclByb3ZpZGVyLnJ1bGUoZnVuY3Rpb24gKCRpbmplY3RvciwgJGxvY2F0aW9uKSB7XG5cblx0XHR2YXIgcmUgPSAvKC4rKShcXC8rKShcXD8uKik/JC87XG5cdFx0dmFyIHBhdGggPSAkbG9jYXRpb24udXJsKCk7XG5cblx0XHRpZihyZS50ZXN0KHBhdGgpKSB7XG5cdFx0XHRyZXR1cm4gcGF0aC5yZXBsYWNlKHJlLCAnJDEkMycpO1xuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fSk7XG5cdC8vIFRoaXMgdHVybnMgb2ZmIGhhc2hiYW5nIHVybHMgKC8jYWJvdXQpIGFuZCBjaGFuZ2VzIGl0IHRvIHNvbWV0aGluZyBub3JtYWwgKC9hYm91dClcblx0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xuXHQkdXJsUm91dGVyUHJvdmlkZXIud2hlbignL2F1dGgvOnByb3ZpZGVyJywgZnVuY3Rpb24gKCkge1xuXHRcdHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcblx0fSk7XG5cdC8vIElmIHdlIGdvIHRvIGEgVVJMIHRoYXQgdWktcm91dGVyIGRvZXNuJ3QgaGF2ZSByZWdpc3RlcmVkLCBnbyB0byB0aGUgXCIvXCIgdXJsLlxuXHQkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG59KTtcbiIsImFwcC5jb250cm9sbGVyKCdhYm91dEN0cmwnLCBmdW5jdGlvbigkc2NvcGUpe1xuXHR2YXIgaW5jcmVtZW50ID0gMDtcblx0dmFyIGNhcm91c2VsID0gJCgnI2Nhcm91c2VsJyk7XG5cdHZhciBjdXJyZW50ID0gJyNmaWctMSc7XG5cdHZhciBwcmV2O1xuXHRzZXRJbnRlcnZhbCggZnVuY3Rpb24oKXtcblx0XHRpbmNyZW1lbnQrKztcblx0XHRjYXJvdXNlbC5jc3Moe1xuXHRcdFx0Jy13ZWJraXQtdHJhbnNmb3JtJzogJ3JvdGF0ZVgoJyArIChpbmNyZW1lbnQgKiAtNjApICsgJ2RlZyknXG5cdFx0fSk7XG5cdFx0Y2Fyb3VzZWwuYXR0cignZGF0YS1zdGF0ZScsKGluY3JlbWVudCAlIDYpICsgMSk7XG5cblx0XHRwcmV2ID0gY3VycmVudDtcblx0XHRjdXJyZW50ID0gJyNmaWctJyArICArICgoaW5jcmVtZW50ICUgNikgKyAxKTtcblx0XHQvLyBjb25zb2xlLmxvZyhjdXJyZW50KTtcblx0XHQvLyAkKGN1cnJlbnQpLmNzcyh7J2JvcmRlci1yYWRpdXMnIDogJzMwcHgnfSk7XG5cdFx0Ly8gJChwcmV2KS5jc3Moeydib3JkZXItcmFkaXVzJyA6ICcwcHgnfSk7XG5cblx0fSwxNTAwKTtcblxuXHR2YXIgY2lyY2xlMSA9ICQoJyNjaXJjbGUtMScpO1xuXHRjb25zb2xlLmxvZygnJGNpcmNsZS0xJywgY2lyY2xlMSk7XG5cdHZhciBjaXJjbGUyID0gJCgnI2NpcmNsZS0yJyk7XG5cdC8vIHZhciBjaXJjbGUzID0gJCgnI2NpcmNsZS0zJyk7XG5cblx0Y2lyY2xlMS5jbGljayhmdW5jdGlvbigpe1xuXHRcdGNpcmNsZTEuYWRkQ2xhc3MoJ3NwaW4tY2xvY2t3aXNlJyk7XG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0Y2lyY2xlMi5hZGRDbGFzcygnc3Bpbi1jb3VudGVyY2xvY2t3aXNlJyk7XG5cdFx0fSw1MDApO1xuXHR9KTtcbn0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ2NvbnRhY3RDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCl7XG5cdCRzY29wZS5mb3JtRGF0YSA9IHt9O1xuXG5cdCRzY29wZS5zZW5kTWFpbCA9IGZ1bmN0aW9uKCl7XG5cdFx0JHNjb3BlLndhaXRpbmcgPSB0cnVlO1xuXHRcdCRzY29wZS5zZW50ID0gZmFsc2U7XG5cdFx0JHNjb3BlLnN1Y2Nlc3MgPSBmYWxzZTtcblx0XHQkaHR0cC5wb3N0KCcvYXBpL2NvbnRhY3QnLCAkc2NvcGUuZm9ybURhdGEpXG5cdFx0LnRoZW4oZnVuY3Rpb24oc3VjY2Vzc1Jlc3BvbnNlKXtcblx0XHRcdGNvbnNvbGUubG9nKHN1Y2Nlc3NSZXNwb25zZSk7XG5cdFx0XHQkc2NvcGUud2FpdGluZyA9IGZhbHNlO1xuXHRcdFx0JHNjb3BlLnNlbnQgPSB0cnVlO1xuXHRcdFx0JHNjb3BlLnN1Y2Nlc3MgPSBzdWNjZXNzUmVzcG9uc2UuZGF0YTtcblx0XHRcdCRzY29wZS5mb3JtRGF0YSA9IHt9O1xuXHRcdH0pO1xuXHR9O1xuXG5cdHZhciBjYXJkID0gJCgnI2NhcmQnKTtcblx0dmFyIG5vdGUgPSAkKCcubm90ZScpO1xuXHR2YXIgdG9nZ2xlID0gdHJ1ZTtcblxuXHRjYXJkLmNsaWNrKGZ1bmN0aW9uKCl7XG5cdFx0aWYgKHRvZ2dsZSl7XG5cdFx0XHRjYXJkLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblx0XHRcdGNhcmQucmVtb3ZlQ2xhc3MoJ2luaXRpYWwnKTtcblx0XHRcdGNhcmQuYWRkQ2xhc3MoJ3Zpc2libGUnKTtcblx0XHRcdG5vdGUuY3NzKHsnZGlzcGxheSc6ICdpbml0aWFsJ30pO1xuXHRcdFx0Ly8gZXhwbG9kZSgpO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coJ2V4cGxvZGVkJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNhcmQucmVtb3ZlQ2xhc3MoJ3Zpc2libGUnKTtcblx0XHRcdGNhcmQuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXHRcdFx0bm90ZS5jc3MoeydkaXNwbGF5JzogJ25vbmUnfSk7XG5cdFx0fVxuXHRcdHRvZ2dsZSA9ICF0b2dnbGU7XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGV4cGxvZGUoKSB7XG5cdFx0XHQvLyBjcsOpYXRpb24gZCd1biB0YWJsZWF1XG5cdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpLFxuXHRcdFx0Y29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksXG5cdFx0XHR3aWR0aCA9IGNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoLFxuXHRcdFx0aGVpZ2h0ID0gY2FudmFzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCxcblx0XHRcdHBhcnRpY2xlID0gW10sXG5cdFx0XHRwYXJ0aWNsZUNvdW50ID0gMCxcblx0XHRcdGdyYXZpdHkgPSAwLjMsXG5cdFx0XHRjb2xvcnMgPSBbXG5cdFx0XHRcdCcjZjQ0MzM2JywgJyNlOTFlNjMnLCAnIzljMjdiMCcsICcjNjczYWI3JywgJyMzZjUxYjUnLFxuXHRcdFx0XHQnIzIxOTZmMycsICcjMDNhOWY0JywgJyMwMGJjZDQnLCAnIzAwOTY4OCcsICcjNENBRjUwJyxcblx0XHRcdFx0JyM4QkMzNEEnLCAnI0NEREMzOScsICcjRkZFQjNCJywgJyNGRkMxMDcnLCAnI0ZGOTgwMCcsXG5cdFx0XHRcdCcjRkY1NzIyJywgJyM3OTU1NDgnXG5cdFx0XHRdO1xuXG5cdFx0Zm9yKCB2YXIgaSA9IDA7IGkgPCAzMDA7IGkrKyl7XG5cdFx0XHRwYXJ0aWNsZS5wdXNoKHtcblx0XHRcdFx0eCA6IHdpZHRoLzIsXG5cdFx0XHRcdHkgOiBoZWlnaHQvMixcblx0XHRcdFx0Ym94VyA6IHJhbmRvbVJhbmdlKDUsMjApLFxuXHRcdFx0XHRib3hIIDogcmFuZG9tUmFuZ2UoNSwyMCksXG5cdFx0XHRcdHNpemUgOiByYW5kb21SYW5nZSgyLDgpLFxuXG5cdFx0XHRcdHNwaWtlcmFuOnJhbmRvbVJhbmdlKDMsNSksXG5cblx0XHRcdFx0dmVsWCA6cmFuZG9tUmFuZ2UoLTgsOCksXG5cdFx0XHRcdHZlbFkgOnJhbmRvbVJhbmdlKC01MCwtMTApLFxuXG5cdFx0XHRcdGFuZ2xlIDpjb252ZXJ0VG9SYWRpYW5zKHJhbmRvbVJhbmdlKDAsMzYwKSksXG5cdFx0XHRcdGNvbG9yOmNvbG9yc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb2xvcnMubGVuZ3RoKV0sXG5cdFx0XHRcdGFuZ2xlc3BpbjpyYW5kb21SYW5nZSgtMC4yLDAuMiksXG5cblx0XHRcdFx0ZHJhdyA6IGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0Y29udGV4dC5zYXZlKCk7XG5cdFx0XHRcdFx0Y29udGV4dC50cmFuc2xhdGUodGhpcy54LHRoaXMueSk7XG5cdFx0XHRcdFx0Y29udGV4dC5yb3RhdGUodGhpcy5hbmdsZSk7XG5cdFx0XHRcdFx0Y29udGV4dC5maWxsU3R5bGU9dGhpcy5jb2xvcjtcblx0XHRcdFx0XHRjb250ZXh0LmJlZ2luUGF0aCgpO1xuXHRcdFx0XHRcdC8vIGRyYXdTdGFyKDAsIDAsIDUsIHRoaXMuYm94VywgdGhpcy5ib3hIKTtcblx0XHRcdFx0XHRjb250ZXh0LmZpbGxSZWN0KHRoaXMuYm94Vy8yKi0xLHRoaXMuYm94SC8yKi0xLHRoaXMuYm94Vyx0aGlzLmJveEgpO1xuXHRcdFx0XHRcdGNvbnRleHQuZmlsbCgpO1xuXHRcdFx0XHRcdGNvbnRleHQuY2xvc2VQYXRoKCk7XG5cdFx0XHRcdFx0Y29udGV4dC5yZXN0b3JlKCk7XG5cdFx0XHRcdFx0dGhpcy5hbmdsZSArPSB0aGlzLmFuZ2xlc3Bpbjtcblx0XHRcdFx0XHR0aGlzLnZlbFkqPSAwLjk5OTtcblx0XHRcdFx0XHR0aGlzLnZlbFkgKz0gMC4zO1xuXHRcdFx0XHRcdHRoaXMueCArPSB0aGlzLnZlbFg7XG5cdFx0XHRcdFx0dGhpcy55ICs9IHRoaXMudmVsWTtcblxuXHRcdFx0XHRcdGlmKHRoaXMueSA8IDApe1xuXHRcdFx0XHRcdFx0dGhpcy52ZWxZICo9IC0wLjI7XG5cdFx0XHRcdFx0XHR0aGlzLnZlbFggKj0gMC45O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAodGhpcy55ID4gaGVpZ2h0KXtcblx0XHRcdFx0XHRcdHRoaXMuYW5nbGVzcGluID0gMDtcblx0XHRcdFx0XHRcdHRoaXMueSA9IGhlaWdodDtcblx0XHRcdFx0XHRcdHRoaXMudmVsWSAqPSAtMC4yO1xuXHRcdFx0XHRcdFx0dGhpcy52ZWxYICo9IDAuOTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHRoaXMueCA+IHdpZHRoIHx8dGhpcy54PCAwKXtcblx0XHRcdFx0XHRcdHRoaXMudmVsWCAqPSAtMC41O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHR9LFxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0dmFyIHIxPXtcblx0XHRcdHg6d2lkdGgvMi0xNTAsXG5cdFx0XHR5OmhlaWdodC8yLTE1MCxcblx0XHRcdHdpZHRoOjMwMCxcblx0XHRcdGhlaWdodDozMDAsXG5cdFx0XHR2ZWxYIDowLFxuXHRcdFx0dmVsWSA6LTEwLFxuXHRcdFx0aW1nIDogbG9hZEltYWdlKFwiaHR0cDovL2ltYWdlLm5vZWxzaGFjay5jb20vZmljaGllcnMvMjAxNS8xMi8xNDI3MDUxNjQyLXNtaWxleS5wbmdcIiksXG5cdFx0XHRhbHBoYXRvcDowXG5cdFx0fTtcblxuXG5cdFx0ZnVuY3Rpb24gZHJhd1NjcmVlbigpe1xuXHRcdFx0dmFyIHNpemUgPSA1MDtcblx0XHRcdHZhciBwRm9udE5hbWUgPSBcIkx1Y2lkYSBTYW5zIFVuaWNvZGVcIjtcblx0XHRcdGNvbnRleHQuZm9udCA9IHNpemUgKyBcInB0IFwiICsgcEZvbnROYW1lO1xuXHRcdFx0Y29udGV4dC5maWxsVGV4dChcIkNvbmZldHRpIHBhcnR5ICEhIVwiLCB3aWR0aC8yLDE1MCApO1xuXHRcdFx0aWYgKHIxLmFscGhhdG9wIDwgMSl7XG5cdFx0XHRcdHIxLmFscGhhdG9wICs9IDAuMDE7XG5cdFx0XHR9IGVsc2V7XG5cdFx0XHRcdHIxLmFscGhhdG9wID0gMTtcblx0XHRcdH1cblx0XHRcdGNvbnRleHQuZ2xvYmFsQWxwaGEgPSByMS5hbHBoYXRvcDtcblx0XHRcdGNvbnRleHQuZHJhd0ltYWdlKHIxLmltZyxyMS54LHIxLnkpO1xuXHRcdFx0Y29udGV4dC50ZXh0QWxpZ24gPSAnY2VudGVyJztcblxuXG5cblx0XHRcdGlmKHIxLmFscGhhdG9wID09PSAxKXtcblx0XHRcdFx0cjEudmVsWSo9IDAuOTk5O1xuXHRcdFx0XHRyMS52ZWxZICs9IDAuMztcblx0XHRcdFx0cjEueCArPSByMS52ZWxYO1xuXHRcdFx0XHRyMS55ICs9IHIxLnZlbFk7XG5cdFx0XHR9XG5cblx0XHRcdGlmKHIxLnkgKyByMS5oZWlnaHQgPiBoZWlnaHQpe1xuXHRcdFx0XHRyMS5hbmdsZXNwaW4gPSAwO1xuXHRcdFx0XHRyMS55ID0gaGVpZ2h0IC0gcjEuaGVpZ2h0O1xuXHRcdFx0XHRyMS52ZWxZICo9IC0wLjg7XG5cdFx0XHRcdHIxLnZlbFggKj0gMC45O1xuXHRcdFx0fVxuXG5cdFx0XHRjb250ZXh0Lmdsb2JhbEFscGhhID0gMTtcblxuXHRcdFx0Zm9yKCB2YXIgaSA9IDA7IGkgPCBwYXJ0aWNsZS5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdHBhcnRpY2xlW2ldLmRyYXcoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiBsb2FkSW1hZ2UodXJsKXtcblx0XHRcdHZhciBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuXHRcdFx0aW1nLnNyYz11cmw7XG5cdFx0XHRyZXR1cm4gaW1nO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHVwZGF0ZSgpe1xuXHRcdFx0Y29udGV4dC5jbGVhclJlY3QoMCwwLHdpZHRoLGhlaWdodCk7XG5cdFx0XHRkcmF3U2NyZWVuKCk7XG5cdFx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUodXBkYXRlKTtcblx0XHR9XG5cblx0XHR1cGRhdGUoKTtcblxuXHRcdGZ1bmN0aW9uIHJhbmRvbVJhbmdlKG1pbiwgbWF4KXtcblx0XHRcdHJldHVybiBtaW4gKyBNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiApO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHJhbmRvbUludChtaW4sIG1heCl7XG5cdFx0XHRyZXR1cm4gTWF0aC5mbG9vcihtaW4gKyBNYXRoLnJhbmRvbSgpKiAobWF4IC0gbWluICsgMSkpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGNvbnZlcnRUb1JhZGlhbnMoZGVncmVlKSB7XG5cdFx0XHRyZXR1cm4gZGVncmVlKihNYXRoLlBJLzE4MCk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZHJhd1N0YXIoY3gsIGN5LCBzcGlrZXMsIG91dGVyUmFkaXVzLCBpbm5lclJhZGl1cyxjb2xvcikge1xuXHRcdFx0dmFyIHJvdCA9IE1hdGguUEkgLyAyICogMztcblx0XHRcdHZhciB4ID0gY3g7XG5cdFx0XHR2YXIgeSA9IGN5O1xuXHRcdFx0dmFyIHN0ZXAgPSBNYXRoLlBJIC8gc3Bpa2VzO1xuXG5cdFx0XHRjb250ZXh0LnN0cm9rZVN5bGUgPSBcIiMwMDBcIjtcblx0XHRcdGNvbnRleHQuYmVnaW5QYXRoKCk7XG5cdFx0XHRjb250ZXh0Lm1vdmVUbyhjeCwgY3kgLSBvdXRlclJhZGl1cyk7XG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCBzcGlrZXM7IGkrKykge1xuXHRcdFx0XHR4ID0gY3ggKyBNYXRoLmNvcyhyb3QpICogb3V0ZXJSYWRpdXM7XG5cdFx0XHRcdHkgPSBjeSArIE1hdGguc2luKHJvdCkgKiBvdXRlclJhZGl1cztcblx0XHRcdFx0Y29udGV4dC5saW5lVG8oeCwgeSk7XG5cdFx0XHRcdHJvdCArPSBzdGVwO1xuXG5cdFx0XHRcdHggPSBjeCArIE1hdGguY29zKHJvdCkgKiBpbm5lclJhZGl1cztcblx0XHRcdFx0eSA9IGN5ICsgTWF0aC5zaW4ocm90KSAqIGlubmVyUmFkaXVzO1xuXHRcdFx0XHRjb250ZXh0LmxpbmVUbyh4LCB5KTtcblx0XHRcdFx0cm90ICs9IHN0ZXA7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnRleHQubGluZVRvKGN4LCBjeSAtIG91dGVyUmFkaXVzKTtcblx0XHRcdGNvbnRleHQuY2xvc2VQYXRoKCk7XG5cdFx0XHRjb250ZXh0LmZpbGxTdHlsZT1jb2xvcjtcblx0XHRcdGNvbnRleHQuZmlsbCgpO1xuXHRcdH1cblx0fVxuXG59KTtcbiIsImFwcC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xuXHQkc3RhdGVQcm92aWRlclxuXHQuc3RhdGUoJ2hvbWUnLCB7XG5cdFx0dXJsOiAnLycsXG5cdFx0dGVtcGxhdGVVcmw6ICcvanMvdGVtcGxhdGVzL2hvbWUuaHRtbCdcblx0fSlcblx0LnN0YXRlKCdwcm9qZWN0cycsIHtcblx0XHR1cmw6ICcvcHJvamVjdHMnLFxuXHRcdHRlbXBsYXRlVXJsOiAnL2pzL3RlbXBsYXRlcy9wcm9qZWN0cy5odG1sJyxcblx0XHRjb250cm9sbGVyOiAncHJvamVjdEN0cmwnXG5cdH0pXG5cdC5zdGF0ZSgnYWJvdXQnLCB7XG5cdFx0dXJsOiAnL2Fib3V0Jyxcblx0XHR0ZW1wbGF0ZVVybDogJy9qcy90ZW1wbGF0ZXMvYWJvdXQuaHRtbCcsXG5cdFx0Y29udHJvbGxlcjogJ2Fib3V0Q3RybCdcblx0fSlcblx0LnN0YXRlKCdjb250YWN0Jywge1xuXHRcdHVybDogJy9jb250YWN0Jyxcblx0XHR0ZW1wbGF0ZVVybDogJy9qcy90ZW1wbGF0ZXMvY29udGFjdC5odG1sJyxcblx0XHRjb250cm9sbGVyOiAnY29udGFjdEN0cmwnXG5cdH0pO1xufSk7XG4iLCJhcHAuY29udHJvbGxlcigncHJvamVjdEN0cmwnLCBmdW5jdGlvbigkc2NvcGUpe1xuXHQkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcblxuXHRcdHZhciBjdXJQYWdlID0gMTtcblx0XHR2YXIgbnVtT2ZQYWdlcyA9ICQoXCIuc2t3LXBhZ2VcIikubGVuZ3RoO1xuXHRcdHZhciBhbmltVGltZSA9IDEwMDA7XG5cdFx0dmFyIHNjcm9sbGluZyA9IGZhbHNlO1xuXHRcdHZhciBwZ1ByZWZpeCA9IFwiLnNrdy1wYWdlLVwiO1xuXG5cdFx0ZnVuY3Rpb24gcGFnaW5hdGlvbigpIHtcblx0XHRcdHNjcm9sbGluZyA9IHRydWU7XG5cblx0XHRcdCQocGdQcmVmaXggKyBjdXJQYWdlKS5yZW1vdmVDbGFzcyhcImluYWN0aXZlXCIpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuXHRcdFx0JChwZ1ByZWZpeCArIChjdXJQYWdlIC0gMSkpLmFkZENsYXNzKFwiaW5hY3RpdmVcIik7XG5cdFx0XHQkKHBnUHJlZml4ICsgKGN1clBhZ2UgKyAxKSkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG5cblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHNjcm9sbGluZyA9IGZhbHNlO1xuXHRcdFx0fSwgYW5pbVRpbWUpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIG5hdmlnYXRlVXAoKSB7XG5cdFx0XHRpZiAoY3VyUGFnZSA9PT0gMSkgcmV0dXJuO1xuXHRcdFx0Y3VyUGFnZS0tO1xuXHRcdFx0cGFnaW5hdGlvbigpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIG5hdmlnYXRlRG93bigpIHtcblx0XHRcdGlmIChjdXJQYWdlID09PSBudW1PZlBhZ2VzKSByZXR1cm47XG5cdFx0XHRjdXJQYWdlKys7XG5cdFx0XHRwYWdpbmF0aW9uKCk7XG5cdFx0fVxuXG5cdFx0JChkb2N1bWVudCkub24oXCJtb3VzZXdoZWVsIERPTU1vdXNlU2Nyb2xsXCIsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdGlmIChzY3JvbGxpbmcpIHJldHVybjtcblx0XHRcdGlmIChlLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YSA+IDAgfHwgZS5vcmlnaW5hbEV2ZW50LmRldGFpbCA8IDApIHtcblx0XHRcdFx0bmF2aWdhdGVVcCgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bmF2aWdhdGVEb3duKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQkKGRvY3VtZW50KS5vbihcImtleWRvd25cIiwgZnVuY3Rpb24oZSkge1xuXHRcdFx0aWYgKHNjcm9sbGluZykgcmV0dXJuO1xuXHRcdFx0aWYgKGUud2hpY2ggPT09IDM4KSB7XG5cdFx0XHRcdG5hdmlnYXRlVXAoKTtcblx0XHRcdH0gZWxzZSBpZiAoZS53aGljaCA9PT0gNDApIHtcblx0XHRcdFx0bmF2aWdhdGVEb3duKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQkKCcjZG93bi1hcnJvdycpLmNsaWNrKGZ1bmN0aW9uKCl7XG5cdFx0XHRjb25zb2xlLmxvZygnY2xpY2tlZCcpO1xuXHRcdFx0aWYgKHNjcm9sbGluZykgcmV0dXJuO1xuXHRcdFx0bmF2aWdhdGVEb3duKCk7XG5cdFx0fSk7XG5cblx0fSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
