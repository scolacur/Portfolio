'use strict';

window.app = angular.module('portfolio', ['ui.router']);

app.config(function ($urlRouterProvider, $locationProvider, $urlMatcherFactoryProvider) {

	// this makes the '/stores/' route correctly redirect to '/stores'
	$urlRouterProvider.rule(function ($injector, $location) {

		var re = /(.+)(\/+)(\?.*)?$/;
		var path = $location.url();

		if (re.test(path)) {
			return path.replace(re, '$1$3');
		}

		return false;
	});
	// This turns off hashbang urls (/#about) and changes it to something normal (/about)
	$locationProvider.html5Mode(true);
	$urlRouterProvider.when('/auth/:provider', function () {
		window.location.reload();
	});
	// If we go to a URL that ui-router doesn't have registered, go to the "/" url.
	$urlRouterProvider.otherwise('/');
});

app.controller('aboutCtrl', function ($scope) {
	var increment = 0;
	var carousel = $('#carousel');
	var current = '#fig-1';
	var prev;
	setInterval(function () {
		increment++;
		carousel.css({
			'-webkit-transform': 'rotateX(' + increment * -60 + 'deg)'
		});
		carousel.attr('data-state', increment % 6 + 1);

		prev = current;
		current = '#fig-' + (increment % 6 + 1);
		// console.log(current);
		// $(current).css({'border-radius' : '30px'});
		// $(prev).css({'border-radius' : '0px'});
	}, 1500);

	var circle1 = $('#circle-1');
	console.log('$circle-1', circle1);
	var circle2 = $('#circle-2');
	// var circle3 = $('#circle-3');

	circle1.click(function () {
		circle1.addClass('spin-clockwise');
		setTimeout(function () {
			circle2.addClass('spin-counterclockwise');
		}, 500);
	});
});

app.controller('contactCtrl', function ($scope, $http) {
	$scope.formData = {};

	$scope.sendMail = function () {
		$scope.waiting = true;
		$scope.sent = false;
		$scope.success = false;
		$http.post('/api/contact', $scope.formData).then(function (successResponse) {
			console.log(successResponse);
			$scope.waiting = false;
			$scope.sent = true;
			$scope.success = successResponse.data;
			$scope.formData = {};
		});
	};

	var card = $('#card');
	var note = $('.note');
	var toggle = true;

	card.click(function () {
		if (toggle) {
			card.removeClass('hidden').removeClass('initial').addClass('visible');
			// note.css({'display': 'initial'});
			setTimeout(explode, 500);
			setTimeout(function () {
				$('#canvas').css({ 'display': 'none' });
			}, 5000);
		} else {
			card.removeClass('visible').addClass('hidden');
			// note.css({'display': 'none'});
		}
		toggle = !toggle;
	});

	function explode() {

		$('#canvas').css({ 'display': 'initial' });

		var requestId;

		var canvas = document.getElementById("canvas"),
		    context = canvas.getContext("2d"),
		    width = canvas.width = window.innerWidth,
		    height = canvas.height = window.innerHeight,
		    particle = [],
		    particleCount = 0,
		    gravity = 0.3,
		    colors =
		// [
		// 	'#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5',
		// 	'#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4CAF50',
		// 	'#8BC34A', '#CDDC39', '#FFEB3B', '#FFC107', '#FF9800',
		// 	'#FF5722', '#795548'
		// ];
		['#7FFFD4', '#E0FFFF', '#33CCFF', '#C688E8', '#FF807D', '#FF8EB2'];

		for (var i = 0; i < 50; i++) {
			particle.push({
				x: width / 7,
				y: height / 2,
				boxW: randomRange(5, 20),
				boxH: randomRange(5, 20),
				size: randomRange(2, 8),

				spikeran: randomRange(3, 5),

				velX: randomRange(-8, 8),
				velY: randomRange(-50, -10),

				angle: convertToRadians(randomRange(0, 360)),
				color: colors[Math.floor(Math.random() * colors.length)],
				anglespin: randomRange(-0.2, 0.2),

				draw: draw
			});
		}

		var r1 = {
			x: width / 2 - 150,
			y: height / 2 - 150,
			width: 300,
			height: 300,
			velX: 0,
			velY: -10,
			alphatop: 0
		};

		function drawScreen() {
			var size = 50;
			if (r1.alphatop < 1) {
				r1.alphatop += 0.01;
			} else {
				r1.alphatop = 1;
			}
			context.globalAlpha = r1.alphatop;

			if (r1.alphatop === 1) {
				r1.velY *= 0.999;
				r1.velY += 0.3;
				r1.x += r1.velX;
				r1.y += r1.velY;
			}

			if (r1.y + r1.height > height) {
				r1.anglespin = 0;
				r1.y = height - r1.height;
				r1.velY *= -0.8;
				r1.velX *= 0.9;
			}

			context.globalAlpha = 1;

			for (var i = 0; i < particle.length; i++) {
				particle[i].draw();
			}
		}

		function update() {
			context.clearRect(0, 0, width, height);
			drawScreen();
			requestId = requestAnimationFrame(update);
		}

		update();

		setTimeout(function () {
			window.cancelAnimationFrame(requestId);
			requestId = undefined;
		}, 5000);

		function randomRange(min, max) {
			return min + Math.random() * (max - min);
		}

		function randomInt(min, max) {
			return Math.floor(min + Math.random() * (max - min + 1));
		}

		function convertToRadians(degree) {
			return degree * (Math.PI / 180);
		}

		function drawStar(cx, cy, spikes, outerRadius, innerRadius, color) {
			var rot = Math.PI / 2 * 3;
			var x = cx;
			var y = cy;
			var step = Math.PI / spikes;

			context.strokeSyle = "#000";
			context.beginPath();
			context.moveTo(cx, cy - outerRadius);
			for (i = 0; i < spikes; i++) {
				x = cx + Math.cos(rot) * outerRadius;
				y = cy + Math.sin(rot) * outerRadius;
				context.lineTo(x, y);
				rot += step;

				x = cx + Math.cos(rot) * innerRadius;
				y = cy + Math.sin(rot) * innerRadius;
				context.lineTo(x, y);
				rot += step;
			}

			context.lineTo(cx, cy - outerRadius);
			context.closePath();
			context.fillStyle = color;
			context.fill();
		}

		function draw() {
			context.save();
			context.translate(this.x, this.y);
			context.rotate(this.angle);
			context.fillStyle = this.color;
			context.beginPath();
			// drawStar(0, 0, 5, this.boxW, this.boxH);
			context.fillRect(this.boxW / 2 * -1, this.boxH / 2 * -1, this.boxW, this.boxH);
			context.fill();
			context.closePath();
			context.restore();
			this.angle += this.anglespin;
			this.velY *= 0.999;
			this.velY += 0.3;
			this.x += this.velX;
			this.y += this.velY;

			if (this.y < 0) {
				this.velY *= -0.2;
				this.velX *= 0.9;
			}
			if (this.y > height) {
				this.anglespin = 0;
				this.y = height;
				this.velY *= -0.2;
				this.velX *= 0.9;
			}
			if (this.x > width || this.x < 0) {
				this.velX *= -0.5;
			}
		}
	}
});

app.config(function ($stateProvider) {
	$stateProvider.state('home', {
		url: '/',
		templateUrl: '/js/templates/home.html'
	}).state('projects', {
		url: '/projects',
		templateUrl: '/js/templates/projects.html',
		controller: 'projectCtrl'
	}).state('about', {
		url: '/about',
		templateUrl: '/js/templates/about.html',
		controller: 'aboutCtrl'
	}).state('contact', {
		url: '/contact',
		templateUrl: '/js/templates/contact.html',
		controller: 'contactCtrl'
	});
});

app.controller('projectCtrl', function ($scope) {
	$(document).ready(function () {

		var curPage = 1;
		var numOfPages = $(".skw-page").length;
		var animTime = 1000;
		var scrolling = false;
		var pgPrefix = ".skw-page-";

		function pagination() {
			scrolling = true;

			$(pgPrefix + curPage).removeClass("inactive").addClass("active");
			$(pgPrefix + (curPage - 1)).addClass("inactive");
			$(pgPrefix + (curPage + 1)).removeClass("active");

			setTimeout(function () {
				scrolling = false;
			}, animTime);
		}

		function navigateUp() {
			if (curPage === 1) return;
			curPage--;
			pagination();
		}

		function navigateDown() {
			if (curPage === numOfPages) return;
			curPage++;
			pagination();
		}

		$(document).on("mousewheel DOMMouseScroll", function (e) {
			if (scrolling) return;
			if (e.originalEvent.wheelDelta > 0 || e.originalEvent.detail < 0) {
				navigateUp();
			} else {
				navigateDown();
			}
		});

		$(document).on("keydown", function (e) {
			if (scrolling) return;
			if (e.which === 38) {
				navigateUp();
			} else if (e.which === 40) {
				navigateDown();
			}
		});

		$('#down-arrow').click(function () {
			if (scrolling) return;
			navigateDown();
		});
	});
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImFib3V0LmpzIiwiY29udGFjdC5qcyIsImhvbWUuanMiLCJwcm9qZWN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsTUFBQSxDQUFBLEdBQUEsR0FBQSxPQUFBLENBQUEsTUFBQSxDQUFBLFdBQUEsRUFBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBLENBQUE7O0FBRUEsR0FBQSxDQUFBLE1BQUEsQ0FBQSxVQUFBLGtCQUFBLEVBQUEsaUJBQUEsRUFBQSwwQkFBQSxFQUFBOzs7QUFHQSxtQkFBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLFNBQUEsRUFBQSxTQUFBLEVBQUE7O0FBRUEsTUFBQSxFQUFBLEdBQUEsbUJBQUEsQ0FBQTtBQUNBLE1BQUEsSUFBQSxHQUFBLFNBQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQTs7QUFFQSxNQUFBLEVBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLEVBQUE7QUFDQSxVQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsRUFBQSxFQUFBLE1BQUEsQ0FBQSxDQUFBO0dBQ0E7O0FBRUEsU0FBQSxLQUFBLENBQUE7RUFDQSxDQUFBOztBQUFBLEFBRUEsa0JBQUEsQ0FBQSxTQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7QUFDQSxtQkFBQSxDQUFBLElBQUEsQ0FBQSxpQkFBQSxFQUFBLFlBQUE7QUFDQSxRQUFBLENBQUEsUUFBQSxDQUFBLE1BQUEsRUFBQSxDQUFBO0VBQ0EsQ0FBQTs7QUFBQSxBQUVBLG1CQUFBLENBQUEsU0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO0NBQ0EsQ0FBQSxDQUFBOztBQ3ZCQSxHQUFBLENBQUEsVUFBQSxDQUFBLFdBQUEsRUFBQSxVQUFBLE1BQUEsRUFBQTtBQUNBLEtBQUEsU0FBQSxHQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsUUFBQSxHQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsT0FBQSxHQUFBLFFBQUEsQ0FBQTtBQUNBLEtBQUEsSUFBQSxDQUFBO0FBQ0EsWUFBQSxDQUFBLFlBQUE7QUFDQSxXQUFBLEVBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxHQUFBLENBQUE7QUFDQSxzQkFBQSxFQUFBLFVBQUEsR0FBQSxTQUFBLEdBQUEsQ0FBQSxFQUFBLEdBQUEsTUFBQTtHQUNBLENBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxJQUFBLENBQUEsWUFBQSxFQUFBLFNBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUE7O0FBRUEsTUFBQSxHQUFBLE9BQUEsQ0FBQTtBQUNBLFNBQUEsR0FBQSxPQUFBLElBQUEsU0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7Ozs7RUFLQSxFQUFBLElBQUEsQ0FBQSxDQUFBO0FBTEE7QUFPQSxLQUFBLE9BQUEsR0FBQSxDQUFBLENBQUEsV0FBQSxDQUFBLENBQUE7QUFDQSxRQUFBLENBQUEsR0FBQSxDQUFBLFdBQUEsRUFBQSxPQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsT0FBQSxHQUFBLENBQUEsQ0FBQSxXQUFBLENBQUE7OztBQUFBLEFBR0EsUUFBQSxDQUFBLEtBQUEsQ0FBQSxZQUFBO0FBQ0EsU0FBQSxDQUFBLFFBQUEsQ0FBQSxnQkFBQSxDQUFBLENBQUE7QUFDQSxZQUFBLENBQUEsWUFBQTtBQUNBLFVBQUEsQ0FBQSxRQUFBLENBQUEsdUJBQUEsQ0FBQSxDQUFBO0dBQ0EsRUFBQSxHQUFBLENBQUEsQ0FBQTtFQUNBLENBQUEsQ0FBQTtDQUNBLENBQUEsQ0FBQTs7QUMvQkEsR0FBQSxDQUFBLFVBQUEsQ0FBQSxhQUFBLEVBQUEsVUFBQSxNQUFBLEVBQUEsS0FBQSxFQUFBO0FBQ0EsT0FBQSxDQUFBLFFBQUEsR0FBQSxFQUFBLENBQUE7O0FBRUEsT0FBQSxDQUFBLFFBQUEsR0FBQSxZQUFBO0FBQ0EsUUFBQSxDQUFBLE9BQUEsR0FBQSxJQUFBLENBQUE7QUFDQSxRQUFBLENBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQTtBQUNBLFFBQUEsQ0FBQSxPQUFBLEdBQUEsS0FBQSxDQUFBO0FBQ0EsT0FBQSxDQUFBLElBQUEsQ0FBQSxjQUFBLEVBQUEsTUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUNBLElBQUEsQ0FBQSxVQUFBLGVBQUEsRUFBQTtBQUNBLFVBQUEsQ0FBQSxHQUFBLENBQUEsZUFBQSxDQUFBLENBQUE7QUFDQSxTQUFBLENBQUEsT0FBQSxHQUFBLEtBQUEsQ0FBQTtBQUNBLFNBQUEsQ0FBQSxJQUFBLEdBQUEsSUFBQSxDQUFBO0FBQ0EsU0FBQSxDQUFBLE9BQUEsR0FBQSxlQUFBLENBQUEsSUFBQSxDQUFBO0FBQ0EsU0FBQSxDQUFBLFFBQUEsR0FBQSxFQUFBLENBQUE7R0FDQSxDQUFBLENBQUE7RUFDQSxDQUFBOztBQUVBLEtBQUEsSUFBQSxHQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsSUFBQSxHQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTtBQUNBLEtBQUEsTUFBQSxHQUFBLElBQUEsQ0FBQTs7QUFFQSxLQUFBLENBQUEsS0FBQSxDQUFBLFlBQUE7QUFDQSxNQUFBLE1BQUEsRUFBQTtBQUNBLE9BQUEsQ0FBQSxXQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsV0FBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FBQSxTQUFBLENBQUE7O0FBQUEsQUFFQSxhQUFBLENBQUEsT0FBQSxFQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQ0EsYUFBQSxDQUFBLFlBQUE7QUFDQSxLQUFBLENBQUEsU0FBQSxDQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsU0FBQSxFQUFBLE1BQUEsRUFBQSxDQUFBLENBQUE7SUFDQSxFQUFBLElBQUEsQ0FBQSxDQUFBO0dBQ0EsTUFBQTtBQUNBLE9BQUEsQ0FBQSxXQUFBLENBQUEsU0FBQSxDQUFBLENBQUEsUUFBQSxDQUFBLFFBQUEsQ0FBQTs7QUFBQSxHQUVBO0FBQ0EsUUFBQSxHQUFBLENBQUEsTUFBQSxDQUFBO0VBQ0EsQ0FBQSxDQUFBOztBQUdBLFVBQUEsT0FBQSxHQUFBOztBQUVBLEdBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsRUFBQSxTQUFBLEVBQUEsU0FBQSxFQUFBLENBQUEsQ0FBQTs7QUFFQSxNQUFBLFNBQUEsQ0FBQTs7QUFFQSxNQUFBLE1BQUEsR0FBQSxRQUFBLENBQUEsY0FBQSxDQUFBLFFBQUEsQ0FBQTtNQUNBLE9BQUEsR0FBQSxNQUFBLENBQUEsVUFBQSxDQUFBLElBQUEsQ0FBQTtNQUNBLEtBQUEsR0FBQSxNQUFBLENBQUEsS0FBQSxHQUFBLE1BQUEsQ0FBQSxVQUFBO01BQ0EsTUFBQSxHQUFBLE1BQUEsQ0FBQSxNQUFBLEdBQUEsTUFBQSxDQUFBLFdBQUE7TUFDQSxRQUFBLEdBQUEsRUFBQTtNQUNBLGFBQUEsR0FBQSxDQUFBO01BQ0EsT0FBQSxHQUFBLEdBQUE7TUFDQSxNQUFBOzs7Ozs7O0FBT0EsR0FBQSxTQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsRUFBQSxTQUFBLEVBQUEsU0FBQSxFQUFBLFNBQUEsQ0FBQSxDQUFBOztBQUVBLE9BQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUE7QUFDQSxXQUFBLENBQUEsSUFBQSxDQUFBO0FBQ0EsS0FBQSxFQUFBLEtBQUEsR0FBQSxDQUFBO0FBQ0EsS0FBQSxFQUFBLE1BQUEsR0FBQSxDQUFBO0FBQ0EsUUFBQSxFQUFBLFdBQUEsQ0FBQSxDQUFBLEVBQUEsRUFBQSxDQUFBO0FBQ0EsUUFBQSxFQUFBLFdBQUEsQ0FBQSxDQUFBLEVBQUEsRUFBQSxDQUFBO0FBQ0EsUUFBQSxFQUFBLFdBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBOztBQUVBLFlBQUEsRUFBQSxXQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQTs7QUFFQSxRQUFBLEVBQUEsV0FBQSxDQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQTtBQUNBLFFBQUEsRUFBQSxXQUFBLENBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUE7O0FBRUEsU0FBQSxFQUFBLGdCQUFBLENBQUEsV0FBQSxDQUFBLENBQUEsRUFBQSxHQUFBLENBQUEsQ0FBQTtBQUNBLFNBQUEsRUFBQSxNQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxFQUFBLEdBQUEsTUFBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBO0FBQ0EsYUFBQSxFQUFBLFdBQUEsQ0FBQSxDQUFBLEdBQUEsRUFBQSxHQUFBLENBQUE7O0FBRUEsUUFBQSxFQUFBLElBQUE7SUFDQSxDQUFBLENBQUE7R0FDQTs7QUFFQSxNQUFBLEVBQUEsR0FBQTtBQUNBLElBQUEsRUFBQSxLQUFBLEdBQUEsQ0FBQSxHQUFBLEdBQUE7QUFDQSxJQUFBLEVBQUEsTUFBQSxHQUFBLENBQUEsR0FBQSxHQUFBO0FBQ0EsUUFBQSxFQUFBLEdBQUE7QUFDQSxTQUFBLEVBQUEsR0FBQTtBQUNBLE9BQUEsRUFBQSxDQUFBO0FBQ0EsT0FBQSxFQUFBLENBQUEsRUFBQTtBQUNBLFdBQUEsRUFBQSxDQUFBO0dBQ0EsQ0FBQTs7QUFHQSxXQUFBLFVBQUEsR0FBQTtBQUNBLE9BQUEsSUFBQSxHQUFBLEVBQUEsQ0FBQTtBQUNBLE9BQUEsRUFBQSxDQUFBLFFBQUEsR0FBQSxDQUFBLEVBQUE7QUFDQSxNQUFBLENBQUEsUUFBQSxJQUFBLElBQUEsQ0FBQTtJQUNBLE1BQUE7QUFDQSxNQUFBLENBQUEsUUFBQSxHQUFBLENBQUEsQ0FBQTtJQUNBO0FBQ0EsVUFBQSxDQUFBLFdBQUEsR0FBQSxFQUFBLENBQUEsUUFBQSxDQUFBOztBQUVBLE9BQUEsRUFBQSxDQUFBLFFBQUEsS0FBQSxDQUFBLEVBQUE7QUFDQSxNQUFBLENBQUEsSUFBQSxJQUFBLEtBQUEsQ0FBQTtBQUNBLE1BQUEsQ0FBQSxJQUFBLElBQUEsR0FBQSxDQUFBO0FBQ0EsTUFBQSxDQUFBLENBQUEsSUFBQSxFQUFBLENBQUEsSUFBQSxDQUFBO0FBQ0EsTUFBQSxDQUFBLENBQUEsSUFBQSxFQUFBLENBQUEsSUFBQSxDQUFBO0lBQ0E7O0FBRUEsT0FBQSxFQUFBLENBQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQSxNQUFBLEdBQUEsTUFBQSxFQUFBO0FBQ0EsTUFBQSxDQUFBLFNBQUEsR0FBQSxDQUFBLENBQUE7QUFDQSxNQUFBLENBQUEsQ0FBQSxHQUFBLE1BQUEsR0FBQSxFQUFBLENBQUEsTUFBQSxDQUFBO0FBQ0EsTUFBQSxDQUFBLElBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQTtBQUNBLE1BQUEsQ0FBQSxJQUFBLElBQUEsR0FBQSxDQUFBO0lBQ0E7O0FBRUEsVUFBQSxDQUFBLFdBQUEsR0FBQSxDQUFBLENBQUE7O0FBRUEsUUFBQSxJQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLFFBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUE7QUFDQSxZQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxFQUFBLENBQUE7SUFDQTtHQUNBOztBQUVBLFdBQUEsTUFBQSxHQUFBO0FBQ0EsVUFBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEtBQUEsRUFBQSxNQUFBLENBQUEsQ0FBQTtBQUNBLGFBQUEsRUFBQSxDQUFBO0FBQ0EsWUFBQSxHQUFBLHFCQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7R0FDQTs7QUFFQSxRQUFBLEVBQUEsQ0FBQTs7QUFFQSxZQUFBLENBQUEsWUFBQTtBQUNBLFNBQUEsQ0FBQSxvQkFBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBO0FBQ0EsWUFBQSxHQUFBLFNBQUEsQ0FBQTtHQUNBLEVBQUEsSUFBQSxDQUFBLENBQUE7O0FBRUEsV0FBQSxXQUFBLENBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQTtBQUNBLFVBQUEsR0FBQSxHQUFBLElBQUEsQ0FBQSxNQUFBLEVBQUEsSUFBQSxHQUFBLEdBQUEsR0FBQSxDQUFBLENBQUE7R0FDQTs7QUFFQSxXQUFBLFNBQUEsQ0FBQSxHQUFBLEVBQUEsR0FBQSxFQUFBO0FBQ0EsVUFBQSxJQUFBLENBQUEsS0FBQSxDQUFBLEdBQUEsR0FBQSxJQUFBLENBQUEsTUFBQSxFQUFBLElBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO0dBQ0E7O0FBRUEsV0FBQSxnQkFBQSxDQUFBLE1BQUEsRUFBQTtBQUNBLFVBQUEsTUFBQSxJQUFBLElBQUEsQ0FBQSxFQUFBLEdBQUEsR0FBQSxDQUFBLENBQUE7R0FDQTs7QUFFQSxXQUFBLFFBQUEsQ0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLE1BQUEsRUFBQSxXQUFBLEVBQUEsV0FBQSxFQUFBLEtBQUEsRUFBQTtBQUNBLE9BQUEsR0FBQSxHQUFBLElBQUEsQ0FBQSxFQUFBLEdBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTtBQUNBLE9BQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQTtBQUNBLE9BQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQTtBQUNBLE9BQUEsSUFBQSxHQUFBLElBQUEsQ0FBQSxFQUFBLEdBQUEsTUFBQSxDQUFBOztBQUVBLFVBQUEsQ0FBQSxVQUFBLEdBQUEsTUFBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLFNBQUEsRUFBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLE1BQUEsQ0FBQSxFQUFBLEVBQUEsRUFBQSxHQUFBLFdBQUEsQ0FBQSxDQUFBO0FBQ0EsUUFBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxNQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUE7QUFDQSxLQUFBLEdBQUEsRUFBQSxHQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsV0FBQSxDQUFBO0FBQ0EsS0FBQSxHQUFBLEVBQUEsR0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxHQUFBLFdBQUEsQ0FBQTtBQUNBLFdBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO0FBQ0EsT0FBQSxJQUFBLElBQUEsQ0FBQTs7QUFFQSxLQUFBLEdBQUEsRUFBQSxHQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsV0FBQSxDQUFBO0FBQ0EsS0FBQSxHQUFBLEVBQUEsR0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxHQUFBLFdBQUEsQ0FBQTtBQUNBLFdBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO0FBQ0EsT0FBQSxJQUFBLElBQUEsQ0FBQTtJQUNBOztBQUVBLFVBQUEsQ0FBQSxNQUFBLENBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxXQUFBLENBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxTQUFBLEVBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxTQUFBLEdBQUEsS0FBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLElBQUEsRUFBQSxDQUFBO0dBQ0E7O0FBRUEsV0FBQSxJQUFBLEdBQUE7QUFDQSxVQUFBLENBQUEsSUFBQSxFQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsU0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLEVBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO0FBQ0EsVUFBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsU0FBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUE7QUFDQSxVQUFBLENBQUEsU0FBQSxFQUFBOztBQUFBLEFBRUEsVUFBQSxDQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxHQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsRUFBQSxJQUFBLENBQUEsSUFBQSxHQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsRUFBQSxJQUFBLENBQUEsSUFBQSxFQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxTQUFBLEVBQUEsQ0FBQTtBQUNBLFVBQUEsQ0FBQSxPQUFBLEVBQUEsQ0FBQTtBQUNBLE9BQUEsQ0FBQSxLQUFBLElBQUEsSUFBQSxDQUFBLFNBQUEsQ0FBQTtBQUNBLE9BQUEsQ0FBQSxJQUFBLElBQUEsS0FBQSxDQUFBO0FBQ0EsT0FBQSxDQUFBLElBQUEsSUFBQSxHQUFBLENBQUE7QUFDQSxPQUFBLENBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxJQUFBLENBQUE7QUFDQSxPQUFBLENBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxJQUFBLENBQUE7O0FBRUEsT0FBQSxJQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsRUFBQTtBQUNBLFFBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxHQUFBLENBQUE7QUFDQSxRQUFBLENBQUEsSUFBQSxJQUFBLEdBQUEsQ0FBQTtJQUNBO0FBQ0EsT0FBQSxJQUFBLENBQUEsQ0FBQSxHQUFBLE1BQUEsRUFBQTtBQUNBLFFBQUEsQ0FBQSxTQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQ0EsUUFBQSxDQUFBLENBQUEsR0FBQSxNQUFBLENBQUE7QUFDQSxRQUFBLENBQUEsSUFBQSxJQUFBLENBQUEsR0FBQSxDQUFBO0FBQ0EsUUFBQSxDQUFBLElBQUEsSUFBQSxHQUFBLENBQUE7SUFDQTtBQUNBLE9BQUEsSUFBQSxDQUFBLENBQUEsR0FBQSxLQUFBLElBQUEsSUFBQSxDQUFBLENBQUEsR0FBQSxDQUFBLEVBQUE7QUFDQSxRQUFBLENBQUEsSUFBQSxJQUFBLENBQUEsR0FBQSxDQUFBO0lBQ0E7R0FFQTtFQUNBO0NBRUEsQ0FBQSxDQUFBOztBQy9NQSxHQUFBLENBQUEsTUFBQSxDQUFBLFVBQUEsY0FBQSxFQUFBO0FBQ0EsZUFBQSxDQUNBLEtBQUEsQ0FBQSxNQUFBLEVBQUE7QUFDQSxLQUFBLEVBQUEsR0FBQTtBQUNBLGFBQUEsRUFBQSx5QkFBQTtFQUNBLENBQUEsQ0FDQSxLQUFBLENBQUEsVUFBQSxFQUFBO0FBQ0EsS0FBQSxFQUFBLFdBQUE7QUFDQSxhQUFBLEVBQUEsNkJBQUE7QUFDQSxZQUFBLEVBQUEsYUFBQTtFQUNBLENBQUEsQ0FDQSxLQUFBLENBQUEsT0FBQSxFQUFBO0FBQ0EsS0FBQSxFQUFBLFFBQUE7QUFDQSxhQUFBLEVBQUEsMEJBQUE7QUFDQSxZQUFBLEVBQUEsV0FBQTtFQUNBLENBQUEsQ0FDQSxLQUFBLENBQUEsU0FBQSxFQUFBO0FBQ0EsS0FBQSxFQUFBLFVBQUE7QUFDQSxhQUFBLEVBQUEsNEJBQUE7QUFDQSxZQUFBLEVBQUEsYUFBQTtFQUNBLENBQUEsQ0FBQTtDQUNBLENBQUEsQ0FBQTs7QUNyQkEsR0FBQSxDQUFBLFVBQUEsQ0FBQSxhQUFBLEVBQUEsVUFBQSxNQUFBLEVBQUE7QUFDQSxFQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsS0FBQSxDQUFBLFlBQUE7O0FBRUEsTUFBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBO0FBQ0EsTUFBQSxVQUFBLEdBQUEsQ0FBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQTtBQUNBLE1BQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtBQUNBLE1BQUEsU0FBQSxHQUFBLEtBQUEsQ0FBQTtBQUNBLE1BQUEsUUFBQSxHQUFBLFlBQUEsQ0FBQTs7QUFFQSxXQUFBLFVBQUEsR0FBQTtBQUNBLFlBQUEsR0FBQSxJQUFBLENBQUE7O0FBRUEsSUFBQSxDQUFBLFFBQUEsR0FBQSxPQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsVUFBQSxDQUFBLENBQUEsUUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBO0FBQ0EsSUFBQSxDQUFBLFFBQUEsSUFBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxRQUFBLENBQUEsVUFBQSxDQUFBLENBQUE7QUFDQSxJQUFBLENBQUEsUUFBQSxJQUFBLE9BQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLFdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTs7QUFFQSxhQUFBLENBQUEsWUFBQTtBQUNBLGFBQUEsR0FBQSxLQUFBLENBQUE7SUFDQSxFQUFBLFFBQUEsQ0FBQSxDQUFBO0dBQ0E7O0FBRUEsV0FBQSxVQUFBLEdBQUE7QUFDQSxPQUFBLE9BQUEsS0FBQSxDQUFBLEVBQUEsT0FBQTtBQUNBLFVBQUEsRUFBQSxDQUFBO0FBQ0EsYUFBQSxFQUFBLENBQUE7R0FDQTs7QUFFQSxXQUFBLFlBQUEsR0FBQTtBQUNBLE9BQUEsT0FBQSxLQUFBLFVBQUEsRUFBQSxPQUFBO0FBQ0EsVUFBQSxFQUFBLENBQUE7QUFDQSxhQUFBLEVBQUEsQ0FBQTtHQUNBOztBQUVBLEdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsMkJBQUEsRUFBQSxVQUFBLENBQUEsRUFBQTtBQUNBLE9BQUEsU0FBQSxFQUFBLE9BQUE7QUFDQSxPQUFBLENBQUEsQ0FBQSxhQUFBLENBQUEsVUFBQSxHQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsYUFBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLEVBQUE7QUFDQSxjQUFBLEVBQUEsQ0FBQTtJQUNBLE1BQUE7QUFDQSxnQkFBQSxFQUFBLENBQUE7SUFDQTtHQUNBLENBQUEsQ0FBQTs7QUFFQSxHQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsRUFBQSxDQUFBLFNBQUEsRUFBQSxVQUFBLENBQUEsRUFBQTtBQUNBLE9BQUEsU0FBQSxFQUFBLE9BQUE7QUFDQSxPQUFBLENBQUEsQ0FBQSxLQUFBLEtBQUEsRUFBQSxFQUFBO0FBQ0EsY0FBQSxFQUFBLENBQUE7SUFDQSxNQUFBLElBQUEsQ0FBQSxDQUFBLEtBQUEsS0FBQSxFQUFBLEVBQUE7QUFDQSxnQkFBQSxFQUFBLENBQUE7SUFDQTtHQUNBLENBQUEsQ0FBQTs7QUFFQSxHQUFBLENBQUEsYUFBQSxDQUFBLENBQUEsS0FBQSxDQUFBLFlBQUE7QUFDQSxPQUFBLFNBQUEsRUFBQSxPQUFBO0FBQ0EsZUFBQSxFQUFBLENBQUE7R0FDQSxDQUFBLENBQUE7RUFFQSxDQUFBLENBQUE7Q0FDQSxDQUFBLENBQUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIndpbmRvdy5hcHAgPSBhbmd1bGFyLm1vZHVsZSgncG9ydGZvbGlvJywgWyd1aS5yb3V0ZXInXSk7XG5cbmFwcC5jb25maWcoZnVuY3Rpb24gKCR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIsICR1cmxNYXRjaGVyRmFjdG9yeVByb3ZpZGVyKSB7XG5cblx0Ly8gdGhpcyBtYWtlcyB0aGUgJy9zdG9yZXMvJyByb3V0ZSBjb3JyZWN0bHkgcmVkaXJlY3QgdG8gJy9zdG9yZXMnXG5cdCR1cmxSb3V0ZXJQcm92aWRlci5ydWxlKGZ1bmN0aW9uICgkaW5qZWN0b3IsICRsb2NhdGlvbikge1xuXG5cdFx0dmFyIHJlID0gLyguKykoXFwvKykoXFw/LiopPyQvO1xuXHRcdHZhciBwYXRoID0gJGxvY2F0aW9uLnVybCgpO1xuXG5cdFx0aWYocmUudGVzdChwYXRoKSkge1xuXHRcdFx0cmV0dXJuIHBhdGgucmVwbGFjZShyZSwgJyQxJDMnKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH0pO1xuXHQvLyBUaGlzIHR1cm5zIG9mZiBoYXNoYmFuZyB1cmxzICgvI2Fib3V0KSBhbmQgY2hhbmdlcyBpdCB0byBzb21ldGhpbmcgbm9ybWFsICgvYWJvdXQpXG5cdCRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcblx0JHVybFJvdXRlclByb3ZpZGVyLndoZW4oJy9hdXRoLzpwcm92aWRlcicsIGZ1bmN0aW9uICgpIHtcblx0XHR3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG5cdH0pO1xuXHQvLyBJZiB3ZSBnbyB0byBhIFVSTCB0aGF0IHVpLXJvdXRlciBkb2Vzbid0IGhhdmUgcmVnaXN0ZXJlZCwgZ28gdG8gdGhlIFwiL1wiIHVybC5cblx0JHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xufSk7XG4iLCJhcHAuY29udHJvbGxlcignYWJvdXRDdHJsJywgZnVuY3Rpb24oJHNjb3BlKXtcblx0dmFyIGluY3JlbWVudCA9IDA7XG5cdHZhciBjYXJvdXNlbCA9ICQoJyNjYXJvdXNlbCcpO1xuXHR2YXIgY3VycmVudCA9ICcjZmlnLTEnO1xuXHR2YXIgcHJldjtcblx0c2V0SW50ZXJ2YWwoIGZ1bmN0aW9uKCl7XG5cdFx0aW5jcmVtZW50Kys7XG5cdFx0Y2Fyb3VzZWwuY3NzKHtcblx0XHRcdCctd2Via2l0LXRyYW5zZm9ybSc6ICdyb3RhdGVYKCcgKyAoaW5jcmVtZW50ICogLTYwKSArICdkZWcpJ1xuXHRcdH0pO1xuXHRcdGNhcm91c2VsLmF0dHIoJ2RhdGEtc3RhdGUnLChpbmNyZW1lbnQgJSA2KSArIDEpO1xuXG5cdFx0cHJldiA9IGN1cnJlbnQ7XG5cdFx0Y3VycmVudCA9ICcjZmlnLScgKyAoKGluY3JlbWVudCAlIDYpICsgMSk7XG5cdFx0Ly8gY29uc29sZS5sb2coY3VycmVudCk7XG5cdFx0Ly8gJChjdXJyZW50KS5jc3Moeydib3JkZXItcmFkaXVzJyA6ICczMHB4J30pO1xuXHRcdC8vICQocHJldikuY3NzKHsnYm9yZGVyLXJhZGl1cycgOiAnMHB4J30pO1xuXG5cdH0sMTUwMCk7XG5cblx0dmFyIGNpcmNsZTEgPSAkKCcjY2lyY2xlLTEnKTtcblx0Y29uc29sZS5sb2coJyRjaXJjbGUtMScsIGNpcmNsZTEpO1xuXHR2YXIgY2lyY2xlMiA9ICQoJyNjaXJjbGUtMicpO1xuXHQvLyB2YXIgY2lyY2xlMyA9ICQoJyNjaXJjbGUtMycpO1xuXG5cdGNpcmNsZTEuY2xpY2soZnVuY3Rpb24oKXtcblx0XHRjaXJjbGUxLmFkZENsYXNzKCdzcGluLWNsb2Nrd2lzZScpO1xuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHRcdGNpcmNsZTIuYWRkQ2xhc3MoJ3NwaW4tY291bnRlcmNsb2Nrd2lzZScpO1xuXHRcdH0sNTAwKTtcblx0fSk7XG59KTtcbiIsImFwcC5jb250cm9sbGVyKCdjb250YWN0Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHApe1xuXHQkc2NvcGUuZm9ybURhdGEgPSB7fTtcblxuXHQkc2NvcGUuc2VuZE1haWwgPSBmdW5jdGlvbigpe1xuXHRcdCRzY29wZS53YWl0aW5nID0gdHJ1ZTtcblx0XHQkc2NvcGUuc2VudCA9IGZhbHNlO1xuXHRcdCRzY29wZS5zdWNjZXNzID0gZmFsc2U7XG5cdFx0JGh0dHAucG9zdCgnL2FwaS9jb250YWN0JywgJHNjb3BlLmZvcm1EYXRhKVxuXHRcdC50aGVuKGZ1bmN0aW9uKHN1Y2Nlc3NSZXNwb25zZSl7XG5cdFx0XHRjb25zb2xlLmxvZyhzdWNjZXNzUmVzcG9uc2UpO1xuXHRcdFx0JHNjb3BlLndhaXRpbmcgPSBmYWxzZTtcblx0XHRcdCRzY29wZS5zZW50ID0gdHJ1ZTtcblx0XHRcdCRzY29wZS5zdWNjZXNzID0gc3VjY2Vzc1Jlc3BvbnNlLmRhdGE7XG5cdFx0XHQkc2NvcGUuZm9ybURhdGEgPSB7fTtcblx0XHR9KTtcblx0fTtcblxuXHR2YXIgY2FyZCA9ICQoJyNjYXJkJyk7XG5cdHZhciBub3RlID0gJCgnLm5vdGUnKTtcblx0dmFyIHRvZ2dsZSA9IHRydWU7XG5cblx0Y2FyZC5jbGljayhmdW5jdGlvbigpe1xuXHRcdGlmICh0b2dnbGUpe1xuXHRcdFx0Y2FyZC5yZW1vdmVDbGFzcygnaGlkZGVuJykucmVtb3ZlQ2xhc3MoJ2luaXRpYWwnKS5hZGRDbGFzcygndmlzaWJsZScpO1xuXHRcdFx0Ly8gbm90ZS5jc3MoeydkaXNwbGF5JzogJ2luaXRpYWwnfSk7XG5cdFx0XHRzZXRUaW1lb3V0KGV4cGxvZGUsIDUwMCk7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdCQoJyNjYW52YXMnKS5jc3MoeydkaXNwbGF5JyA6ICdub25lJ30pO1xuXHRcdFx0fSwgNTAwMCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNhcmQucmVtb3ZlQ2xhc3MoJ3Zpc2libGUnKS5hZGRDbGFzcygnaGlkZGVuJyk7XG5cdFx0XHQvLyBub3RlLmNzcyh7J2Rpc3BsYXknOiAnbm9uZSd9KTtcblx0XHR9XG5cdFx0dG9nZ2xlID0gIXRvZ2dsZTtcblx0fSk7XG5cblxuXHRmdW5jdGlvbiBleHBsb2RlKCkge1xuXG5cdFx0JCgnI2NhbnZhcycpLmNzcyh7J2Rpc3BsYXknIDogJ2luaXRpYWwnfSk7XG5cblx0XHR2YXIgcmVxdWVzdElkO1xuXG5cdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpLFxuXHRcdFx0Y29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiksXG5cdFx0XHR3aWR0aCA9IGNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoLFxuXHRcdFx0aGVpZ2h0ID0gY2FudmFzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCxcblx0XHRcdHBhcnRpY2xlID0gW10sXG5cdFx0XHRwYXJ0aWNsZUNvdW50ID0gMCxcblx0XHRcdGdyYXZpdHkgPSAwLjMsXG5cdFx0XHRjb2xvcnMgPVxuXHRcdFx0Ly8gW1xuXHRcdFx0Ly8gXHQnI2Y0NDMzNicsICcjZTkxZTYzJywgJyM5YzI3YjAnLCAnIzY3M2FiNycsICcjM2Y1MWI1Jyxcblx0XHRcdC8vIFx0JyMyMTk2ZjMnLCAnIzAzYTlmNCcsICcjMDBiY2Q0JywgJyMwMDk2ODgnLCAnIzRDQUY1MCcsXG5cdFx0XHQvLyBcdCcjOEJDMzRBJywgJyNDRERDMzknLCAnI0ZGRUIzQicsICcjRkZDMTA3JywgJyNGRjk4MDAnLFxuXHRcdFx0Ly8gXHQnI0ZGNTcyMicsICcjNzk1NTQ4J1xuXHRcdFx0Ly8gXTtcblx0XHRcdFsnIzdGRkZENCcsJyNFMEZGRkYnLCcjMzNDQ0ZGJywnI0M2ODhFOCcsJyNGRjgwN0QnLCcjRkY4RUIyJ107XG5cblx0XHRmb3IoIHZhciBpID0gMDsgaSA8IDUwOyBpKyspe1xuXHRcdFx0cGFydGljbGUucHVzaCh7XG5cdFx0XHRcdHggOiB3aWR0aC83LFxuXHRcdFx0XHR5IDogaGVpZ2h0LzIsXG5cdFx0XHRcdGJveFcgOiByYW5kb21SYW5nZSg1LDIwKSxcblx0XHRcdFx0Ym94SCA6IHJhbmRvbVJhbmdlKDUsMjApLFxuXHRcdFx0XHRzaXplIDogcmFuZG9tUmFuZ2UoMiw4KSxcblxuXHRcdFx0XHRzcGlrZXJhbjpyYW5kb21SYW5nZSgzLDUpLFxuXG5cdFx0XHRcdHZlbFggOnJhbmRvbVJhbmdlKC04LDgpLFxuXHRcdFx0XHR2ZWxZIDpyYW5kb21SYW5nZSgtNTAsLTEwKSxcblxuXHRcdFx0XHRhbmdsZSA6Y29udmVydFRvUmFkaWFucyhyYW5kb21SYW5nZSgwLDM2MCkpLFxuXHRcdFx0XHRjb2xvcjpjb2xvcnNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY29sb3JzLmxlbmd0aCldLFxuXHRcdFx0XHRhbmdsZXNwaW46cmFuZG9tUmFuZ2UoLTAuMiwwLjIpLFxuXG5cdFx0XHRcdGRyYXcgOiBkcmF3XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHR2YXIgcjE9e1xuXHRcdFx0eDp3aWR0aC8yLTE1MCxcblx0XHRcdHk6aGVpZ2h0LzItMTUwLFxuXHRcdFx0d2lkdGg6MzAwLFxuXHRcdFx0aGVpZ2h0OjMwMCxcblx0XHRcdHZlbFggOjAsXG5cdFx0XHR2ZWxZIDotMTAsXG5cdFx0XHRhbHBoYXRvcDowXG5cdFx0fTtcblxuXG5cdFx0ZnVuY3Rpb24gZHJhd1NjcmVlbigpe1xuXHRcdFx0dmFyIHNpemUgPSA1MDtcblx0XHRcdGlmIChyMS5hbHBoYXRvcCA8IDEpe1xuXHRcdFx0XHRyMS5hbHBoYXRvcCArPSAwLjAxO1xuXHRcdFx0fSBlbHNle1xuXHRcdFx0XHRyMS5hbHBoYXRvcCA9IDE7XG5cdFx0XHR9XG5cdFx0XHRjb250ZXh0Lmdsb2JhbEFscGhhID0gcjEuYWxwaGF0b3A7XG5cblx0XHRcdGlmKHIxLmFscGhhdG9wID09PSAxKXtcblx0XHRcdFx0cjEudmVsWSo9IDAuOTk5O1xuXHRcdFx0XHRyMS52ZWxZICs9IDAuMztcblx0XHRcdFx0cjEueCArPSByMS52ZWxYO1xuXHRcdFx0XHRyMS55ICs9IHIxLnZlbFk7XG5cdFx0XHR9XG5cblx0XHRcdGlmKHIxLnkgKyByMS5oZWlnaHQgPiBoZWlnaHQpe1xuXHRcdFx0XHRyMS5hbmdsZXNwaW4gPSAwO1xuXHRcdFx0XHRyMS55ID0gaGVpZ2h0IC0gcjEuaGVpZ2h0O1xuXHRcdFx0XHRyMS52ZWxZICo9IC0wLjg7XG5cdFx0XHRcdHIxLnZlbFggKj0gMC45O1xuXHRcdFx0fVxuXG5cdFx0XHRjb250ZXh0Lmdsb2JhbEFscGhhID0gMTtcblxuXHRcdFx0Zm9yKCB2YXIgaSA9IDA7IGkgPCBwYXJ0aWNsZS5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdHBhcnRpY2xlW2ldLmRyYXcoKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmdW5jdGlvbiB1cGRhdGUoKXtcblx0XHRcdGNvbnRleHQuY2xlYXJSZWN0KDAsMCx3aWR0aCxoZWlnaHQpO1xuXHRcdFx0ZHJhd1NjcmVlbigpO1xuXHRcdFx0cmVxdWVzdElkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHVwZGF0ZSk7XG5cdFx0fVxuXG5cdFx0dXBkYXRlKCk7XG5cblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHR3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUocmVxdWVzdElkKTtcblx0XHRcdHJlcXVlc3RJZCA9IHVuZGVmaW5lZDtcblx0XHR9LDUwMDApO1xuXG5cdFx0ZnVuY3Rpb24gcmFuZG9tUmFuZ2UobWluLCBtYXgpe1xuXHRcdFx0cmV0dXJuIG1pbiArIE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gcmFuZG9tSW50KG1pbiwgbWF4KXtcblx0XHRcdHJldHVybiBNYXRoLmZsb29yKG1pbiArIE1hdGgucmFuZG9tKCkqIChtYXggLSBtaW4gKyAxKSk7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gY29udmVydFRvUmFkaWFucyhkZWdyZWUpIHtcblx0XHRcdHJldHVybiBkZWdyZWUqKE1hdGguUEkvMTgwKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBkcmF3U3RhcihjeCwgY3ksIHNwaWtlcywgb3V0ZXJSYWRpdXMsIGlubmVyUmFkaXVzLGNvbG9yKSB7XG5cdFx0XHR2YXIgcm90ID0gTWF0aC5QSSAvIDIgKiAzO1xuXHRcdFx0dmFyIHggPSBjeDtcblx0XHRcdHZhciB5ID0gY3k7XG5cdFx0XHR2YXIgc3RlcCA9IE1hdGguUEkgLyBzcGlrZXM7XG5cblx0XHRcdGNvbnRleHQuc3Ryb2tlU3lsZSA9IFwiIzAwMFwiO1xuXHRcdFx0Y29udGV4dC5iZWdpblBhdGgoKTtcblx0XHRcdGNvbnRleHQubW92ZVRvKGN4LCBjeSAtIG91dGVyUmFkaXVzKTtcblx0XHRcdGZvciAoaSA9IDA7IGkgPCBzcGlrZXM7IGkrKykge1xuXHRcdFx0XHR4ID0gY3ggKyBNYXRoLmNvcyhyb3QpICogb3V0ZXJSYWRpdXM7XG5cdFx0XHRcdHkgPSBjeSArIE1hdGguc2luKHJvdCkgKiBvdXRlclJhZGl1cztcblx0XHRcdFx0Y29udGV4dC5saW5lVG8oeCwgeSk7XG5cdFx0XHRcdHJvdCArPSBzdGVwO1xuXG5cdFx0XHRcdHggPSBjeCArIE1hdGguY29zKHJvdCkgKiBpbm5lclJhZGl1cztcblx0XHRcdFx0eSA9IGN5ICsgTWF0aC5zaW4ocm90KSAqIGlubmVyUmFkaXVzO1xuXHRcdFx0XHRjb250ZXh0LmxpbmVUbyh4LCB5KTtcblx0XHRcdFx0cm90ICs9IHN0ZXA7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnRleHQubGluZVRvKGN4LCBjeSAtIG91dGVyUmFkaXVzKTtcblx0XHRcdGNvbnRleHQuY2xvc2VQYXRoKCk7XG5cdFx0XHRjb250ZXh0LmZpbGxTdHlsZT1jb2xvcjtcblx0XHRcdGNvbnRleHQuZmlsbCgpO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIGRyYXcoKXtcblx0XHRcdGNvbnRleHQuc2F2ZSgpO1xuXHRcdFx0Y29udGV4dC50cmFuc2xhdGUodGhpcy54LHRoaXMueSk7XG5cdFx0XHRjb250ZXh0LnJvdGF0ZSh0aGlzLmFuZ2xlKTtcblx0XHRcdGNvbnRleHQuZmlsbFN0eWxlPXRoaXMuY29sb3I7XG5cdFx0XHRjb250ZXh0LmJlZ2luUGF0aCgpO1xuXHRcdFx0Ly8gZHJhd1N0YXIoMCwgMCwgNSwgdGhpcy5ib3hXLCB0aGlzLmJveEgpO1xuXHRcdFx0Y29udGV4dC5maWxsUmVjdCh0aGlzLmJveFcvMiotMSx0aGlzLmJveEgvMiotMSx0aGlzLmJveFcsdGhpcy5ib3hIKTtcblx0XHRcdGNvbnRleHQuZmlsbCgpO1xuXHRcdFx0Y29udGV4dC5jbG9zZVBhdGgoKTtcblx0XHRcdGNvbnRleHQucmVzdG9yZSgpO1xuXHRcdFx0dGhpcy5hbmdsZSArPSB0aGlzLmFuZ2xlc3Bpbjtcblx0XHRcdHRoaXMudmVsWSo9IDAuOTk5O1xuXHRcdFx0dGhpcy52ZWxZICs9IDAuMztcblx0XHRcdHRoaXMueCArPSB0aGlzLnZlbFg7XG5cdFx0XHR0aGlzLnkgKz0gdGhpcy52ZWxZO1xuXG5cdFx0XHRpZih0aGlzLnkgPCAwKXtcblx0XHRcdFx0dGhpcy52ZWxZICo9IC0wLjI7XG5cdFx0XHRcdHRoaXMudmVsWCAqPSAwLjk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy55ID4gaGVpZ2h0KXtcblx0XHRcdFx0dGhpcy5hbmdsZXNwaW4gPSAwO1xuXHRcdFx0XHR0aGlzLnkgPSBoZWlnaHQ7XG5cdFx0XHRcdHRoaXMudmVsWSAqPSAtMC4yO1xuXHRcdFx0XHR0aGlzLnZlbFggKj0gMC45O1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMueCA+IHdpZHRoIHx8dGhpcy54PCAwKXtcblx0XHRcdFx0dGhpcy52ZWxYICo9IC0wLjU7XG5cdFx0XHR9XG5cblx0XHR9XG5cdH1cblxufSk7XG4iLCJhcHAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcblx0JHN0YXRlUHJvdmlkZXJcblx0LnN0YXRlKCdob21lJywge1xuXHRcdHVybDogJy8nLFxuXHRcdHRlbXBsYXRlVXJsOiAnL2pzL3RlbXBsYXRlcy9ob21lLmh0bWwnXG5cdH0pXG5cdC5zdGF0ZSgncHJvamVjdHMnLCB7XG5cdFx0dXJsOiAnL3Byb2plY3RzJyxcblx0XHR0ZW1wbGF0ZVVybDogJy9qcy90ZW1wbGF0ZXMvcHJvamVjdHMuaHRtbCcsXG5cdFx0Y29udHJvbGxlcjogJ3Byb2plY3RDdHJsJ1xuXHR9KVxuXHQuc3RhdGUoJ2Fib3V0Jywge1xuXHRcdHVybDogJy9hYm91dCcsXG5cdFx0dGVtcGxhdGVVcmw6ICcvanMvdGVtcGxhdGVzL2Fib3V0Lmh0bWwnLFxuXHRcdGNvbnRyb2xsZXI6ICdhYm91dEN0cmwnXG5cdH0pXG5cdC5zdGF0ZSgnY29udGFjdCcsIHtcblx0XHR1cmw6ICcvY29udGFjdCcsXG5cdFx0dGVtcGxhdGVVcmw6ICcvanMvdGVtcGxhdGVzL2NvbnRhY3QuaHRtbCcsXG5cdFx0Y29udHJvbGxlcjogJ2NvbnRhY3RDdHJsJ1xuXHR9KTtcbn0pO1xuIiwiYXBwLmNvbnRyb2xsZXIoJ3Byb2plY3RDdHJsJywgZnVuY3Rpb24oJHNjb3BlKXtcblx0JChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG5cblx0XHR2YXIgY3VyUGFnZSA9IDE7XG5cdFx0dmFyIG51bU9mUGFnZXMgPSAkKFwiLnNrdy1wYWdlXCIpLmxlbmd0aDtcblx0XHR2YXIgYW5pbVRpbWUgPSAxMDAwO1xuXHRcdHZhciBzY3JvbGxpbmcgPSBmYWxzZTtcblx0XHR2YXIgcGdQcmVmaXggPSBcIi5za3ctcGFnZS1cIjtcblxuXHRcdGZ1bmN0aW9uIHBhZ2luYXRpb24oKSB7XG5cdFx0XHRzY3JvbGxpbmcgPSB0cnVlO1xuXG5cdFx0XHQkKHBnUHJlZml4ICsgY3VyUGFnZSkucmVtb3ZlQ2xhc3MoXCJpbmFjdGl2ZVwiKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblx0XHRcdCQocGdQcmVmaXggKyAoY3VyUGFnZSAtIDEpKS5hZGRDbGFzcyhcImluYWN0aXZlXCIpO1xuXHRcdFx0JChwZ1ByZWZpeCArIChjdXJQYWdlICsgMSkpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRzY3JvbGxpbmcgPSBmYWxzZTtcblx0XHRcdH0sIGFuaW1UaW1lKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBuYXZpZ2F0ZVVwKCkge1xuXHRcdFx0aWYgKGN1clBhZ2UgPT09IDEpIHJldHVybjtcblx0XHRcdGN1clBhZ2UtLTtcblx0XHRcdHBhZ2luYXRpb24oKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBuYXZpZ2F0ZURvd24oKSB7XG5cdFx0XHRpZiAoY3VyUGFnZSA9PT0gbnVtT2ZQYWdlcykgcmV0dXJuO1xuXHRcdFx0Y3VyUGFnZSsrO1xuXHRcdFx0cGFnaW5hdGlvbigpO1xuXHRcdH1cblxuXHRcdCQoZG9jdW1lbnQpLm9uKFwibW91c2V3aGVlbCBET01Nb3VzZVNjcm9sbFwiLCBmdW5jdGlvbihlKSB7XG5cdFx0XHRpZiAoc2Nyb2xsaW5nKSByZXR1cm47XG5cdFx0XHRpZiAoZS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGEgPiAwIHx8IGUub3JpZ2luYWxFdmVudC5kZXRhaWwgPCAwKSB7XG5cdFx0XHRcdG5hdmlnYXRlVXAoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG5hdmlnYXRlRG93bigpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0JChkb2N1bWVudCkub24oXCJrZXlkb3duXCIsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdGlmIChzY3JvbGxpbmcpIHJldHVybjtcblx0XHRcdGlmIChlLndoaWNoID09PSAzOCkge1xuXHRcdFx0XHRuYXZpZ2F0ZVVwKCk7XG5cdFx0XHR9IGVsc2UgaWYgKGUud2hpY2ggPT09IDQwKSB7XG5cdFx0XHRcdG5hdmlnYXRlRG93bigpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0JCgnI2Rvd24tYXJyb3cnKS5jbGljayhmdW5jdGlvbigpe1xuXHRcdFx0aWYgKHNjcm9sbGluZykgcmV0dXJuO1xuXHRcdFx0bmF2aWdhdGVEb3duKCk7XG5cdFx0fSk7XG5cblx0fSk7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
